{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1482924334000},{"_id":"themes/next/.DS_Store","hash":"9457f542cf2c3f2a50b9ecd64858fc6f50b0d0c4","modified":1482925338000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1482924334000},{"_id":"themes/next/.gitignore","hash":"5f09fca02e030b7676c1d312cd88ce8fbccf381c","modified":1482924334000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1482924334000},{"_id":"themes/next/.javascript_ignore","hash":"f9ea3c5395f8feb225a24e2c32baa79afda30c16","modified":1482924334000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1482924334000},{"_id":"themes/next/README.en.md","hash":"565ba52b3825b85a9f05b41183caca7f18b741d4","modified":1482924334000},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1482924334000},{"_id":"themes/next/bower.json","hash":"5abc236d9cc2512f5457ed57c1fba76669eb7399","modified":1482924334000},{"_id":"themes/next/_config.yml","hash":"977d9ccdd4bd46b6ff401eb0abac2b538cb5188c","modified":1482924885000},{"_id":"themes/next/gulpfile.coffee","hash":"61ef0606a8134894d7ac796bc8d0fa4ba6a94483","modified":1482924334000},{"_id":"themes/next/package.json","hash":"877cb98025e59015532c4c9a04a33e2af4ad56f9","modified":1482924334000},{"_id":"source/_posts/2pc.md","hash":"3d6b59bd0cbe3ca2b5962cbbde4f6aefce53c329","modified":1482928551000},{"_id":"source/_posts/LVS四层负载均衡.md","hash":"40027c6658913effcc19a696ea1be6a1955b5ce8","modified":1482926856000},{"_id":"source/_posts/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1482916273000},{"_id":"source/_posts/overrideclassloader.md","hash":"5d64b04b2d1a4d4244f86411baf6b1891fda11e6","modified":1483585903000},{"_id":"source/tags/index.md","hash":"8d63fc6da1f15d6dbeb3f48b98cb6f30b3982d43","modified":1482926059000},{"_id":"source/_posts/protocol-buffer-demo.md","hash":"21fefc79aa5bf200a7a03433747b6ced9e2b56cb","modified":1483585583000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"c2024ded82143807c28a299c5fe6b927ef3525ff","modified":1482924334000},{"_id":"themes/next/languages/de.yml","hash":"1fdea1f84b7f691f5b4dd4d2b43eeb27b10fa0c8","modified":1482924334000},{"_id":"themes/next/languages/default.yml","hash":"767470a80dc257e23e14c3a78e8c52a46c9d6209","modified":1482924334000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5ab257af816986cd0e53f9527a92d5934ac70ae9","modified":1482924334000},{"_id":"themes/next/languages/id.yml","hash":"34396bef27c4ab9e9a3c5d3e3aa94b0e3b3a7b0d","modified":1482924334000},{"_id":"themes/next/languages/fr-FR.yml","hash":"9fca01ef917d33ae2ae6bc04561ec6799dff5351","modified":1482924334000},{"_id":"themes/next/languages/en.yml","hash":"40057d6608e825d06e0864bac4dcd27ed88ada87","modified":1482924334000},{"_id":"themes/next/languages/ko.yml","hash":"b6bc5d6b0c000deb44099b42d3aebb8c49dbfca9","modified":1482924334000},{"_id":"themes/next/languages/pt-BR.yml","hash":"7742ba4c0d682cbe1d38305332ebc928abd754b5","modified":1482924334000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"f6c9fafa0f5f0050cd07ca2cf5e38fbae3e28145","modified":1482924334000},{"_id":"themes/next/languages/pt.yml","hash":"6b660b117314cad93f08757601df3adb04c68beb","modified":1482924334000},{"_id":"themes/next/languages/ru.yml","hash":"257d11e626cbe4b9b78785a764190b9278f95c28","modified":1482924334000},{"_id":"themes/next/scripts/merge-configs.js","hash":"0c56be2e85c694247cfa327ea6d627b99ca265e8","modified":1482924334000},{"_id":"themes/next/languages/zh-hk.yml","hash":"34c84c6d04447a25bd5eac576922a13947c000e2","modified":1482924334000},{"_id":"themes/next/languages/ja.yml","hash":"49f12149edcc1892b26a6207328cda64da20116d","modified":1482924334000},{"_id":"themes/next/languages/zh-tw.yml","hash":"c97a5c41149de9b17f33439b0ecf0eff6fdae50e","modified":1482924334000},{"_id":"themes/next/layout/category.swig","hash":"6422d196ceaff4220d54b8af770e7e957f3364ad","modified":1482924334000},{"_id":"themes/next/layout/page.swig","hash":"3727fab9dadb967e9c2204edca787dc72264674a","modified":1482924334000},{"_id":"themes/next/layout/index.swig","hash":"427d0b95b854e311ae363088ab39a393bf8fdc8b","modified":1482924334000},{"_id":"themes/next/layout/archive.swig","hash":"b5b59d70fc1563f482fa07afd435752774ad5981","modified":1482924334000},{"_id":"themes/next/layout/_layout.swig","hash":"7a1e4443c3ba1e08c20e64ddbf0b8255d034dab0","modified":1482924334000},{"_id":"themes/next/layout/post.swig","hash":"e2e512142961ddfe77eba29eaa88f4a2ee43ae18","modified":1482924334000},{"_id":"themes/next/layout/schedule.swig","hash":"1f1cdc268f4ef773fd3ae693bbdf7d0b2f45c3a3","modified":1482924334000},{"_id":"themes/next/layout/tag.swig","hash":"07cf49c49c39a14dfbe9ce8e7d7eea3d4d0a4911","modified":1482924334000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1482924334000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1482924334000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1482924334000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1482924334000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1482924334000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1482924334000},{"_id":"themes/next/scripts/tags/note.js","hash":"6752925eedbdb939d8ec4d11bdfb75199f18dd70","modified":1482924334000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1482924334000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1482924334000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1482924334000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1482924334000},{"_id":"themes/next/source/images/avatar.png","hash":"3a45da7250565a1614d16558992bfe194db8e27d","modified":1482925526000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1482924334000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1482924334000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1482924334000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1482924334000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1482924334000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1482924334000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1482924334000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1482924334000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1482924334000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1482924334000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1482924334000},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1482924334000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1482924334000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"5864f5567ba5efeabcf6ea355013c0b603ee07f2","modified":1482924334000},{"_id":"themes/next/layout/_macro/post.swig","hash":"39a8efd961ea2c5758ca4231d3cc4108c1856930","modified":1482924334000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1482924334000},{"_id":"themes/next/layout/_partials/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1482924334000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1482924334000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4eb278f7b1b7dfe1088c2b411778cc6129df82bb","modified":1482924334000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"43d8830bb19da4fc7a5773866be19fa066b62645","modified":1482924334000},{"_id":"themes/next/layout/_partials/head.swig","hash":"ca56f92e2fa82b03853869f5073ee1a5626a4796","modified":1482924334000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"7172c6053118b7c291a56a7860128a652ae66b83","modified":1482924334000},{"_id":"themes/next/layout/_partials/header.swig","hash":"5696ee15fc21eb3a6416902afcf1df454497c552","modified":1482924334000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"39d613e5a9f8389d4ea52d6082502af8e833b9f2","modified":1482924334000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1482924334000},{"_id":"themes/next/layout/_partials/search.swig","hash":"1431719d1dbba3f5ee385eebc46376d1a960b2d5","modified":1482924334000},{"_id":"themes/next/layout/_scripts/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1482924334000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1482924334000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1482924334000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"0b91cadecead8e0b5211cc42b085998d94af503a","modified":1482924334000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1482924334000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1482924334000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"bef514826ebf9eb6e99bb2b0d72285106658a1ec","modified":1482924334000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"3f0d6aa424f434e82ea507f740eeff110f996269","modified":1482924334000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1482924334000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1482924334000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1482924334000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1482924334000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"96b29f69b8b916b22f62c9959a117b5a968200a5","modified":1482924334000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"39bf93769d9080fa01a9a875183b43198f79bc19","modified":1482924334000},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1482924334000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1482924334000},{"_id":"themes/next/source/js/src/post-details.js","hash":"2038f54e289b6da5def09689e69f623187147be5","modified":1482924334000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1482924334000},{"_id":"themes/next/source/js/src/utils.js","hash":"384e17ff857f073060f5bf8c6e4f4b7353236331","modified":1482924334000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1482924334000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"c1072942459fa0880e8a33a1bd929176b62b4171","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1482924334000},{"_id":"themes/next/layout/_components/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1482924334000},{"_id":"themes/next/layout/_components/algolia-search/dom.swig","hash":"636f1181dd5887a70b4a08ca8f655d4e46635792","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1482924334000},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1482924334000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1482924334000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1482924334000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1482924334000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"ff5523d5dacaa77a55a24e50e6e6530c3b98bfad","modified":1482924334000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1482924334000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1482924334000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1482924334000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1482924334000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1482924334000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1482924334000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics.swig","hash":"394d9fff7951287cc90f52acc2d4cbfd1bae079d","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/comments.swig","hash":"417e16a0fbdcb1b87987787bd7f9fa17eefc2d2b","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/localsearch.swig","hash":"b460e27db3dcd4ab40b17d8926a5c4e624f293a9","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1482924334000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1482924334000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1482924334000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"5304f99581da3a31de3ecec959b7adf9002fde83","modified":1482924334000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1482924334000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"54c90cf7bdbf5c596179d8dae6e671bad1292662","modified":1482924334000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"b49efc66bd055a2d0be7deabfcb02ee72a9a28c8","modified":1482924334000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"10994990d6e0b4d965a728a22cf7f6ee29cae9f6","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"ff9f163bb05c0709577040a875924d36c9ab99d6","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"4303776991ef28f5742ca51c7dffe6f12f0acf34","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_full-image.styl","hash":"938d39eedc6e3d33918c1145a5bf1e79991d3fcf","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"dcf9fe43b2ef78b923118ba39efedb38760e76b1","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"d09280e5b79f3b573edb30f30c7a5f03ac640986","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"7e899c4c0aa1312666f2534a4700667d1bfd88da","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9b63bd8effc7cf4b96acdea4d73add7df934a222","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"82bbaa6322764779a1ac2e2c8390ce901c7972e2","modified":1482924334000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"9ccee9189c910b8a264802d7b2ec305d12dedcd0","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1482924334000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"fb5b49426dee7f1508500e698d1b3c6b04c8fcce","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"4eda182cbcc046dbf449aef97c02c230cf80a494","modified":1482924334000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1482924334000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/comments/gentie.swig","hash":"03592d1d731592103a41ebb87437fe4b0a4c78ca","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/comments/disqus.swig","hash":"fb1d04ede838b52ca7541973f86c3810f1ad396e","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/busuanzi-counter.swig","hash":"4fcbf57c4918528ab51d3d042cff92cf5aefb599","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1482924334000},{"_id":"themes/next/layout/_scripts/third-party/analytics/google-analytics.swig","hash":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1482924334000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"c890ce7fe933abad7baf39764a01894924854e92","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"4b7f81e1006e7acee3d1c840ccba155239f830cc","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"74d0ba86f698165d13402670382a822c8736a556","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"618f73450cf541f88a4fddc3d22898aee49d105d","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"3eb73cee103b810fa56901577ecb9c9bb1793cff","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"c44f6a553ec7ea5508f2054a13be33a62a15d3a9","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"7690b9596ec3a49befbe529a5a2649abec0faf76","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"2d3abbc85b979a648e0e579e45f16a6eba49d1e7","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"eba491ae624b4c843c8be4c94a044085dad4ba0f","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"b03f891883446f3a5548b7cc90d29c77e62f1053","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/gentie.styl","hash":"586a3ec0f1015e7207cd6a2474362e068c341744","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"42348219db93a85d2ee23cb06cebd4d8ab121726","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"637c6b32c58ecf40041be6e911471cd82671919b","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"b25132fe6a7ad67059a2c3afc60feabb479bdd75","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8fae54591877a73dff0b29b2be2e8935e3c63575","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"7f1aab694caf603809e33cff82beea84cd0128fd","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"c6dab7661a6b8c678b21b7eb273cef7100f970f6","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-more-link.styl","hash":"15063d79b5befc21820baf05d6f20cc1c1787477","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"4eb18b12fa0ea6c35925d9a64f64e2a7dae8c7fd","modified":1482924334000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1482924334000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1482924334000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1482924334000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1482924334000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"c0522272bbaef2acb3d341912754d6ea2d0ecfc0","modified":1482924334000}],"Category":[],"Data":[],"Page":[{"title":"tags","date":"2016-12-28T11:53:38.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2016-12-28 19:53:38\ntype: \"tags\"\ncomments: false\n---\n","updated":"2016-12-28T11:54:19.000Z","path":"tags/index.html","layout":"page","_id":"cixq3mp9c0001ez0t9l2fvune","content":"","excerpt":"","more":""}],"Post":[{"title":"分布式事务2PC协议","date":"2016-12-28T12:50:26.000Z","_content":"### 分布式一致性问题\n\n* ACID是事务的基本标准，最终的目的就是一致性和持久性，其中原子性和隔离性只是为了满足前面2条的手段；原子性的基本原则是对数据的操作要么全部生效，要么全部不生效；隔离性至少保证在同一批数据的范围内，操作是互斥或者串行的，也就是对相同数据A来说在事务N没有完成之前事务M是不能操作数据A的，要么事务M失败，要么等待N完成。\n\n* 在分布式场景下要想满足原子性的要求，需要在本地事务的基础上想办法，也就是说分布式事务的原子性=进程内原子性保证+进程之间原子性保证，进程内原子性就不说了，可以参考数据库上Redo和Undo的思路，进程之间的原子性就是保证要么所有的进程全部成功，要么全部失败，隔离性就是保证在某个数据分区上互斥或者串行，所以进程之间最简单的事务实现就是每个机器执行事务，失败的话all roll back，成功的事务完结 ，这就是经典的2PC协议。\n\n* 一旦进去网络环境就有一个问题，网络的不可靠，一旦机器不可达，你并不知道是不是机器宕掉了还是简单的网络不可达，所以单机要有自恢复能力，也就是说必须记录我执行到哪儿了，一旦网络可达（不管是宕机恢复还是网络恢复），单机首先进入恢复模式，记录住自己的状态，然后向标准主机（master）同步数据，达到统一模式再进去对外提供服务的状态，这就是最原始的分布一致性协议的衍生过程，这个和ZK的ZAB协议思路非常相似。\n\n* 2PC也就是二阶段提交，是分布式事务处理常用的一致性算法，利用该协议非常方便完成各个参与者的协调，统一决定事务的提交和回滚，从而能保证分布式数据的一致性。\n\n### 2PC事务提交过程\n* 提交事务请求阶段\n协调者提交事务预执行询问-->参与者事务预执行（取决于本地事务完成，比如将Undo和Redo信息记入事务日志中）-->参与者返回协调者ACK、NO或者超时\n* 提交事务执行阶段\n当阶段一所有的参与者返回ACK消息，执行事务提交阶段：\n协调者提交事务执行-->参与者提交事务本地提交-->参与者返回协调者ACK消息-->事务完成\n当阶段一部分参与者返回NO消息或者部分执行超时，执行事务回滚阶段：\n协调者提交事务rollback-->参与者提交本地rollback-->参与者返回协调者ACK消息-->事务完成。\n\n\n### 2PC优点\n* 简单明了，实现方便。\n\n### 2PC缺点\n* 同步阻塞：\n2PC最大的一个问题就是同步阻塞，就是在2次阶段组成一个完成的事务，在这个过程中所有的参与者都是阻塞的，其中来看就是大部分时间在等待其他参与者的响应而不是真正进行逻辑计算。\n* 单点问题\n单点问题大问题出在协调者的角色上，当协调者执行本地任务还未来得及发出commit或者rollback或者发出部分命令（只有部分参与者收到commit或者rollback命令），这时候整个2PC阶段就无法运转甚至部分参与者一直锁定，同时也总成数据可能不一致。\n* 太过保守\n当任意一台参与者因为本身的原因失败或者宕机或造成，协调者只能等待超时，没有做到更好的时效。整个事务流程全部失败，这明显和分布式设计的初衷有偏差，分布式本身就是为了综合极速能力并且极佳的水平扩缩性，这个容错设计是非常保守的。\n","source":"_posts/2pc.md","raw":"---\ntitle: 分布式事务2PC协议\ndate: 2016-12-28 20:50:26\ntags: 分布式\n---\n### 分布式一致性问题\n\n* ACID是事务的基本标准，最终的目的就是一致性和持久性，其中原子性和隔离性只是为了满足前面2条的手段；原子性的基本原则是对数据的操作要么全部生效，要么全部不生效；隔离性至少保证在同一批数据的范围内，操作是互斥或者串行的，也就是对相同数据A来说在事务N没有完成之前事务M是不能操作数据A的，要么事务M失败，要么等待N完成。\n\n* 在分布式场景下要想满足原子性的要求，需要在本地事务的基础上想办法，也就是说分布式事务的原子性=进程内原子性保证+进程之间原子性保证，进程内原子性就不说了，可以参考数据库上Redo和Undo的思路，进程之间的原子性就是保证要么所有的进程全部成功，要么全部失败，隔离性就是保证在某个数据分区上互斥或者串行，所以进程之间最简单的事务实现就是每个机器执行事务，失败的话all roll back，成功的事务完结 ，这就是经典的2PC协议。\n\n* 一旦进去网络环境就有一个问题，网络的不可靠，一旦机器不可达，你并不知道是不是机器宕掉了还是简单的网络不可达，所以单机要有自恢复能力，也就是说必须记录我执行到哪儿了，一旦网络可达（不管是宕机恢复还是网络恢复），单机首先进入恢复模式，记录住自己的状态，然后向标准主机（master）同步数据，达到统一模式再进去对外提供服务的状态，这就是最原始的分布一致性协议的衍生过程，这个和ZK的ZAB协议思路非常相似。\n\n* 2PC也就是二阶段提交，是分布式事务处理常用的一致性算法，利用该协议非常方便完成各个参与者的协调，统一决定事务的提交和回滚，从而能保证分布式数据的一致性。\n\n### 2PC事务提交过程\n* 提交事务请求阶段\n协调者提交事务预执行询问-->参与者事务预执行（取决于本地事务完成，比如将Undo和Redo信息记入事务日志中）-->参与者返回协调者ACK、NO或者超时\n* 提交事务执行阶段\n当阶段一所有的参与者返回ACK消息，执行事务提交阶段：\n协调者提交事务执行-->参与者提交事务本地提交-->参与者返回协调者ACK消息-->事务完成\n当阶段一部分参与者返回NO消息或者部分执行超时，执行事务回滚阶段：\n协调者提交事务rollback-->参与者提交本地rollback-->参与者返回协调者ACK消息-->事务完成。\n\n\n### 2PC优点\n* 简单明了，实现方便。\n\n### 2PC缺点\n* 同步阻塞：\n2PC最大的一个问题就是同步阻塞，就是在2次阶段组成一个完成的事务，在这个过程中所有的参与者都是阻塞的，其中来看就是大部分时间在等待其他参与者的响应而不是真正进行逻辑计算。\n* 单点问题\n单点问题大问题出在协调者的角色上，当协调者执行本地任务还未来得及发出commit或者rollback或者发出部分命令（只有部分参与者收到commit或者rollback命令），这时候整个2PC阶段就无法运转甚至部分参与者一直锁定，同时也总成数据可能不一致。\n* 太过保守\n当任意一台参与者因为本身的原因失败或者宕机或造成，协调者只能等待超时，没有做到更好的时效。整个事务流程全部失败，这明显和分布式设计的初衷有偏差，分布式本身就是为了综合极速能力并且极佳的水平扩缩性，这个容错设计是非常保守的。\n","slug":"2pc","published":1,"updated":"2016-12-28T12:35:51.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cixq3mp950000ez0tzz1a60ri","content":"<h3 id=\"&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\"><a href=\"#&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\" class=\"headerlink\" title=\"&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\"></a>&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;</h3><ul>\n<li><p>ACID&#x662F;&#x4E8B;&#x52A1;&#x7684;&#x57FA;&#x672C;&#x6807;&#x51C6;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x6301;&#x4E45;&#x6027;&#xFF0C;&#x5176;&#x4E2D;&#x539F;&#x5B50;&#x6027;&#x548C;&#x9694;&#x79BB;&#x6027;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x524D;&#x9762;2&#x6761;&#x7684;&#x624B;&#x6BB5;&#xFF1B;&#x539F;&#x5B50;&#x6027;&#x7684;&#x57FA;&#x672C;&#x539F;&#x5219;&#x662F;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x64CD;&#x4F5C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x751F;&#x6548;&#xFF0C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x4E0D;&#x751F;&#x6548;&#xFF1B;&#x9694;&#x79BB;&#x6027;&#x81F3;&#x5C11;&#x4FDD;&#x8BC1;&#x5728;&#x540C;&#x4E00;&#x6279;&#x6570;&#x636E;&#x7684;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x64CD;&#x4F5C;&#x662F;&#x4E92;&#x65A5;&#x6216;&#x8005;&#x4E32;&#x884C;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5BF9;&#x76F8;&#x540C;&#x6570;&#x636E;A&#x6765;&#x8BF4;&#x5728;&#x4E8B;&#x52A1;N&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x4E8B;&#x52A1;M&#x662F;&#x4E0D;&#x80FD;&#x64CD;&#x4F5C;&#x6570;&#x636E;A&#x7684;&#xFF0C;&#x8981;&#x4E48;&#x4E8B;&#x52A1;M&#x5931;&#x8D25;&#xFF0C;&#x8981;&#x4E48;&#x7B49;&#x5F85;N&#x5B8C;&#x6210;&#x3002;</p>\n</li>\n<li><p>&#x5728;&#x5206;&#x5E03;&#x5F0F;&#x573A;&#x666F;&#x4E0B;&#x8981;&#x60F3;&#x6EE1;&#x8DB3;&#x539F;&#x5B50;&#x6027;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x672C;&#x5730;&#x4E8B;&#x52A1;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x60F3;&#x529E;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x7684;&#x539F;&#x5B50;&#x6027;=&#x8FDB;&#x7A0B;&#x5185;&#x539F;&#x5B50;&#x6027;&#x4FDD;&#x8BC1;+&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x539F;&#x5B50;&#x6027;&#x4FDD;&#x8BC1;&#xFF0C;&#x8FDB;&#x7A0B;&#x5185;&#x539F;&#x5B50;&#x6027;&#x5C31;&#x4E0D;&#x8BF4;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x6570;&#x636E;&#x5E93;&#x4E0A;Redo&#x548C;Undo&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x539F;&#x5B50;&#x6027;&#x5C31;&#x662F;&#x4FDD;&#x8BC1;&#x8981;&#x4E48;&#x6240;&#x6709;&#x7684;&#x8FDB;&#x7A0B;&#x5168;&#x90E8;&#x6210;&#x529F;&#xFF0C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x5931;&#x8D25;&#xFF0C;&#x9694;&#x79BB;&#x6027;&#x5C31;&#x662F;&#x4FDD;&#x8BC1;&#x5728;&#x67D0;&#x4E2A;&#x6570;&#x636E;&#x5206;&#x533A;&#x4E0A;&#x4E92;&#x65A5;&#x6216;&#x8005;&#x4E32;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x5C31;&#x662F;&#x6BCF;&#x4E2A;&#x673A;&#x5668;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#xFF0C;&#x5931;&#x8D25;&#x7684;&#x8BDD;all roll back&#xFF0C;&#x6210;&#x529F;&#x7684;&#x4E8B;&#x52A1;&#x5B8C;&#x7ED3; &#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x7ECF;&#x5178;&#x7684;2PC&#x534F;&#x8BAE;&#x3002;</p>\n</li>\n<li><p>&#x4E00;&#x65E6;&#x8FDB;&#x53BB;&#x7F51;&#x7EDC;&#x73AF;&#x5883;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x7F51;&#x7EDC;&#x7684;&#x4E0D;&#x53EF;&#x9760;&#xFF0C;&#x4E00;&#x65E6;&#x673A;&#x5668;&#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x4F60;&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x4E0D;&#x662F;&#x673A;&#x5668;&#x5B95;&#x6389;&#x4E86;&#x8FD8;&#x662F;&#x7B80;&#x5355;&#x7684;&#x7F51;&#x7EDC;&#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x6240;&#x4EE5;&#x5355;&#x673A;&#x8981;&#x6709;&#x81EA;&#x6062;&#x590D;&#x80FD;&#x529B;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5FC5;&#x987B;&#x8BB0;&#x5F55;&#x6211;&#x6267;&#x884C;&#x5230;&#x54EA;&#x513F;&#x4E86;&#xFF0C;&#x4E00;&#x65E6;&#x7F51;&#x7EDC;&#x53EF;&#x8FBE;&#xFF08;&#x4E0D;&#x7BA1;&#x662F;&#x5B95;&#x673A;&#x6062;&#x590D;&#x8FD8;&#x662F;&#x7F51;&#x7EDC;&#x6062;&#x590D;&#xFF09;&#xFF0C;&#x5355;&#x673A;&#x9996;&#x5148;&#x8FDB;&#x5165;&#x6062;&#x590D;&#x6A21;&#x5F0F;&#xFF0C;&#x8BB0;&#x5F55;&#x4F4F;&#x81EA;&#x5DF1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x540E;&#x5411;&#x6807;&#x51C6;&#x4E3B;&#x673A;&#xFF08;master&#xFF09;&#x540C;&#x6B65;&#x6570;&#x636E;&#xFF0C;&#x8FBE;&#x5230;&#x7EDF;&#x4E00;&#x6A21;&#x5F0F;&#x518D;&#x8FDB;&#x53BB;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6700;&#x539F;&#x59CB;&#x7684;&#x5206;&#x5E03;&#x4E00;&#x81F4;&#x6027;&#x534F;&#x8BAE;&#x7684;&#x884D;&#x751F;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x548C;ZK&#x7684;ZAB&#x534F;&#x8BAE;&#x601D;&#x8DEF;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#x3002;</p>\n</li>\n<li><p>2PC&#x4E5F;&#x5C31;&#x662F;&#x4E8C;&#x9636;&#x6BB5;&#x63D0;&#x4EA4;&#xFF0C;&#x662F;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x5904;&#x7406;&#x5E38;&#x7528;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x7B97;&#x6CD5;&#xFF0C;&#x5229;&#x7528;&#x8BE5;&#x534F;&#x8BAE;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#x5B8C;&#x6210;&#x5404;&#x4E2A;&#x53C2;&#x4E0E;&#x8005;&#x7684;&#x534F;&#x8C03;&#xFF0C;&#x7EDF;&#x4E00;&#x51B3;&#x5B9A;&#x4E8B;&#x52A1;&#x7684;&#x63D0;&#x4EA4;&#x548C;&#x56DE;&#x6EDA;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x4FDD;&#x8BC1;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x3002;</p>\n</li>\n</ul>\n<h3 id=\"2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\"><a href=\"#2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\" class=\"headerlink\" title=\"2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\"></a>2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;</h3><ul>\n<li>&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x8BF7;&#x6C42;&#x9636;&#x6BB5;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x9884;&#x6267;&#x884C;&#x8BE2;&#x95EE;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x4E8B;&#x52A1;&#x9884;&#x6267;&#x884C;&#xFF08;&#x53D6;&#x51B3;&#x4E8E;&#x672C;&#x5730;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#xFF0C;&#x6BD4;&#x5982;&#x5C06;Undo&#x548C;Redo&#x4FE1;&#x606F;&#x8BB0;&#x5165;&#x4E8B;&#x52A1;&#x65E5;&#x5FD7;&#x4E2D;&#xFF09;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x3001;NO&#x6216;&#x8005;&#x8D85;&#x65F6;</li>\n<li>&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x9636;&#x6BB5;<br>&#x5F53;&#x9636;&#x6BB5;&#x4E00;&#x6240;&#x6709;&#x7684;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;ACK&#x6D88;&#x606F;&#xFF0C;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x9636;&#x6BB5;&#xFF1A;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x672C;&#x5730;&#x63D0;&#x4EA4;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x6D88;&#x606F;&#x2013;&gt;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;<br>&#x5F53;&#x9636;&#x6BB5;&#x4E00;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;NO&#x6D88;&#x606F;&#x6216;&#x8005;&#x90E8;&#x5206;&#x6267;&#x884C;&#x8D85;&#x65F6;&#xFF0C;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x56DE;&#x6EDA;&#x9636;&#x6BB5;&#xFF1A;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;rollback&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x63D0;&#x4EA4;&#x672C;&#x5730;rollback&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x6D88;&#x606F;&#x2013;&gt;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#x3002;</li>\n</ul>\n<h3 id=\"2PC&#x4F18;&#x70B9;\"><a href=\"#2PC&#x4F18;&#x70B9;\" class=\"headerlink\" title=\"2PC&#x4F18;&#x70B9;\"></a>2PC&#x4F18;&#x70B9;</h3><ul>\n<li>&#x7B80;&#x5355;&#x660E;&#x4E86;&#xFF0C;&#x5B9E;&#x73B0;&#x65B9;&#x4FBF;&#x3002;</li>\n</ul>\n<h3 id=\"2PC&#x7F3A;&#x70B9;\"><a href=\"#2PC&#x7F3A;&#x70B9;\" class=\"headerlink\" title=\"2PC&#x7F3A;&#x70B9;\"></a>2PC&#x7F3A;&#x70B9;</h3><ul>\n<li>&#x540C;&#x6B65;&#x963B;&#x585E;&#xFF1A;<br>2PC&#x6700;&#x5927;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x540C;&#x6B65;&#x963B;&#x585E;&#xFF0C;&#x5C31;&#x662F;&#x5728;2&#x6B21;&#x9636;&#x6BB5;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x5B8C;&#x6210;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x53C2;&#x4E0E;&#x8005;&#x90FD;&#x662F;&#x963B;&#x585E;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x6765;&#x770B;&#x5C31;&#x662F;&#x5927;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x5728;&#x7B49;&#x5F85;&#x5176;&#x4ED6;&#x53C2;&#x4E0E;&#x8005;&#x7684;&#x54CD;&#x5E94;&#x800C;&#x4E0D;&#x662F;&#x771F;&#x6B63;&#x8FDB;&#x884C;&#x903B;&#x8F91;&#x8BA1;&#x7B97;&#x3002;</li>\n<li>&#x5355;&#x70B9;&#x95EE;&#x9898;<br>&#x5355;&#x70B9;&#x95EE;&#x9898;&#x5927;&#x95EE;&#x9898;&#x51FA;&#x5728;&#x534F;&#x8C03;&#x8005;&#x7684;&#x89D2;&#x8272;&#x4E0A;&#xFF0C;&#x5F53;&#x534F;&#x8C03;&#x8005;&#x6267;&#x884C;&#x672C;&#x5730;&#x4EFB;&#x52A1;&#x8FD8;&#x672A;&#x6765;&#x5F97;&#x53CA;&#x53D1;&#x51FA;commit&#x6216;&#x8005;rollback&#x6216;&#x8005;&#x53D1;&#x51FA;&#x90E8;&#x5206;&#x547D;&#x4EE4;&#xFF08;&#x53EA;&#x6709;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x6536;&#x5230;commit&#x6216;&#x8005;rollback&#x547D;&#x4EE4;&#xFF09;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x6574;&#x4E2A;2PC&#x9636;&#x6BB5;&#x5C31;&#x65E0;&#x6CD5;&#x8FD0;&#x8F6C;&#x751A;&#x81F3;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x4E00;&#x76F4;&#x9501;&#x5B9A;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x603B;&#x6210;&#x6570;&#x636E;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x81F4;&#x3002;</li>\n<li>&#x592A;&#x8FC7;&#x4FDD;&#x5B88;<br>&#x5F53;&#x4EFB;&#x610F;&#x4E00;&#x53F0;&#x53C2;&#x4E0E;&#x8005;&#x56E0;&#x4E3A;&#x672C;&#x8EAB;&#x7684;&#x539F;&#x56E0;&#x5931;&#x8D25;&#x6216;&#x8005;&#x5B95;&#x673A;&#x6216;&#x9020;&#x6210;&#xFF0C;&#x534F;&#x8C03;&#x8005;&#x53EA;&#x80FD;&#x7B49;&#x5F85;&#x8D85;&#x65F6;&#xFF0C;&#x6CA1;&#x6709;&#x505A;&#x5230;&#x66F4;&#x597D;&#x7684;&#x65F6;&#x6548;&#x3002;&#x6574;&#x4E2A;&#x4E8B;&#x52A1;&#x6D41;&#x7A0B;&#x5168;&#x90E8;&#x5931;&#x8D25;&#xFF0C;&#x8FD9;&#x660E;&#x663E;&#x548C;&#x5206;&#x5E03;&#x5F0F;&#x8BBE;&#x8BA1;&#x7684;&#x521D;&#x8877;&#x6709;&#x504F;&#x5DEE;&#xFF0C;&#x5206;&#x5E03;&#x5F0F;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x7EFC;&#x5408;&#x6781;&#x901F;&#x80FD;&#x529B;&#x5E76;&#x4E14;&#x6781;&#x4F73;&#x7684;&#x6C34;&#x5E73;&#x6269;&#x7F29;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BB9;&#x9519;&#x8BBE;&#x8BA1;&#x662F;&#x975E;&#x5E38;&#x4FDD;&#x5B88;&#x7684;&#x3002;</li>\n</ul>\n","excerpt":"","more":"<h3 id=\"&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\"><a href=\"#&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\" class=\"headerlink\" title=\"&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;\"></a>&#x5206;&#x5E03;&#x5F0F;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;</h3><ul>\n<li><p>ACID&#x662F;&#x4E8B;&#x52A1;&#x7684;&#x57FA;&#x672C;&#x6807;&#x51C6;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x6301;&#x4E45;&#x6027;&#xFF0C;&#x5176;&#x4E2D;&#x539F;&#x5B50;&#x6027;&#x548C;&#x9694;&#x79BB;&#x6027;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x524D;&#x9762;2&#x6761;&#x7684;&#x624B;&#x6BB5;&#xFF1B;&#x539F;&#x5B50;&#x6027;&#x7684;&#x57FA;&#x672C;&#x539F;&#x5219;&#x662F;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x64CD;&#x4F5C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x751F;&#x6548;&#xFF0C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x4E0D;&#x751F;&#x6548;&#xFF1B;&#x9694;&#x79BB;&#x6027;&#x81F3;&#x5C11;&#x4FDD;&#x8BC1;&#x5728;&#x540C;&#x4E00;&#x6279;&#x6570;&#x636E;&#x7684;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x64CD;&#x4F5C;&#x662F;&#x4E92;&#x65A5;&#x6216;&#x8005;&#x4E32;&#x884C;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5BF9;&#x76F8;&#x540C;&#x6570;&#x636E;A&#x6765;&#x8BF4;&#x5728;&#x4E8B;&#x52A1;N&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x4E8B;&#x52A1;M&#x662F;&#x4E0D;&#x80FD;&#x64CD;&#x4F5C;&#x6570;&#x636E;A&#x7684;&#xFF0C;&#x8981;&#x4E48;&#x4E8B;&#x52A1;M&#x5931;&#x8D25;&#xFF0C;&#x8981;&#x4E48;&#x7B49;&#x5F85;N&#x5B8C;&#x6210;&#x3002;</p>\n</li>\n<li><p>&#x5728;&#x5206;&#x5E03;&#x5F0F;&#x573A;&#x666F;&#x4E0B;&#x8981;&#x60F3;&#x6EE1;&#x8DB3;&#x539F;&#x5B50;&#x6027;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x672C;&#x5730;&#x4E8B;&#x52A1;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x60F3;&#x529E;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x7684;&#x539F;&#x5B50;&#x6027;=&#x8FDB;&#x7A0B;&#x5185;&#x539F;&#x5B50;&#x6027;&#x4FDD;&#x8BC1;+&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x539F;&#x5B50;&#x6027;&#x4FDD;&#x8BC1;&#xFF0C;&#x8FDB;&#x7A0B;&#x5185;&#x539F;&#x5B50;&#x6027;&#x5C31;&#x4E0D;&#x8BF4;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x6570;&#x636E;&#x5E93;&#x4E0A;Redo&#x548C;Undo&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x539F;&#x5B50;&#x6027;&#x5C31;&#x662F;&#x4FDD;&#x8BC1;&#x8981;&#x4E48;&#x6240;&#x6709;&#x7684;&#x8FDB;&#x7A0B;&#x5168;&#x90E8;&#x6210;&#x529F;&#xFF0C;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x5931;&#x8D25;&#xFF0C;&#x9694;&#x79BB;&#x6027;&#x5C31;&#x662F;&#x4FDD;&#x8BC1;&#x5728;&#x67D0;&#x4E2A;&#x6570;&#x636E;&#x5206;&#x533A;&#x4E0A;&#x4E92;&#x65A5;&#x6216;&#x8005;&#x4E32;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x5C31;&#x662F;&#x6BCF;&#x4E2A;&#x673A;&#x5668;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#xFF0C;&#x5931;&#x8D25;&#x7684;&#x8BDD;all roll back&#xFF0C;&#x6210;&#x529F;&#x7684;&#x4E8B;&#x52A1;&#x5B8C;&#x7ED3; &#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x7ECF;&#x5178;&#x7684;2PC&#x534F;&#x8BAE;&#x3002;</p>\n</li>\n<li><p>&#x4E00;&#x65E6;&#x8FDB;&#x53BB;&#x7F51;&#x7EDC;&#x73AF;&#x5883;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x7F51;&#x7EDC;&#x7684;&#x4E0D;&#x53EF;&#x9760;&#xFF0C;&#x4E00;&#x65E6;&#x673A;&#x5668;&#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x4F60;&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x4E0D;&#x662F;&#x673A;&#x5668;&#x5B95;&#x6389;&#x4E86;&#x8FD8;&#x662F;&#x7B80;&#x5355;&#x7684;&#x7F51;&#x7EDC;&#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x6240;&#x4EE5;&#x5355;&#x673A;&#x8981;&#x6709;&#x81EA;&#x6062;&#x590D;&#x80FD;&#x529B;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5FC5;&#x987B;&#x8BB0;&#x5F55;&#x6211;&#x6267;&#x884C;&#x5230;&#x54EA;&#x513F;&#x4E86;&#xFF0C;&#x4E00;&#x65E6;&#x7F51;&#x7EDC;&#x53EF;&#x8FBE;&#xFF08;&#x4E0D;&#x7BA1;&#x662F;&#x5B95;&#x673A;&#x6062;&#x590D;&#x8FD8;&#x662F;&#x7F51;&#x7EDC;&#x6062;&#x590D;&#xFF09;&#xFF0C;&#x5355;&#x673A;&#x9996;&#x5148;&#x8FDB;&#x5165;&#x6062;&#x590D;&#x6A21;&#x5F0F;&#xFF0C;&#x8BB0;&#x5F55;&#x4F4F;&#x81EA;&#x5DF1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x540E;&#x5411;&#x6807;&#x51C6;&#x4E3B;&#x673A;&#xFF08;master&#xFF09;&#x540C;&#x6B65;&#x6570;&#x636E;&#xFF0C;&#x8FBE;&#x5230;&#x7EDF;&#x4E00;&#x6A21;&#x5F0F;&#x518D;&#x8FDB;&#x53BB;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6700;&#x539F;&#x59CB;&#x7684;&#x5206;&#x5E03;&#x4E00;&#x81F4;&#x6027;&#x534F;&#x8BAE;&#x7684;&#x884D;&#x751F;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x548C;ZK&#x7684;ZAB&#x534F;&#x8BAE;&#x601D;&#x8DEF;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#x3002;</p>\n</li>\n<li><p>2PC&#x4E5F;&#x5C31;&#x662F;&#x4E8C;&#x9636;&#x6BB5;&#x63D0;&#x4EA4;&#xFF0C;&#x662F;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x5904;&#x7406;&#x5E38;&#x7528;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x7B97;&#x6CD5;&#xFF0C;&#x5229;&#x7528;&#x8BE5;&#x534F;&#x8BAE;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#x5B8C;&#x6210;&#x5404;&#x4E2A;&#x53C2;&#x4E0E;&#x8005;&#x7684;&#x534F;&#x8C03;&#xFF0C;&#x7EDF;&#x4E00;&#x51B3;&#x5B9A;&#x4E8B;&#x52A1;&#x7684;&#x63D0;&#x4EA4;&#x548C;&#x56DE;&#x6EDA;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x4FDD;&#x8BC1;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x3002;</p>\n</li>\n</ul>\n<h3 id=\"2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\"><a href=\"#2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\" class=\"headerlink\" title=\"2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;\"></a>2PC&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x8FC7;&#x7A0B;</h3><ul>\n<li>&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x8BF7;&#x6C42;&#x9636;&#x6BB5;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x9884;&#x6267;&#x884C;&#x8BE2;&#x95EE;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x4E8B;&#x52A1;&#x9884;&#x6267;&#x884C;&#xFF08;&#x53D6;&#x51B3;&#x4E8E;&#x672C;&#x5730;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#xFF0C;&#x6BD4;&#x5982;&#x5C06;Undo&#x548C;Redo&#x4FE1;&#x606F;&#x8BB0;&#x5165;&#x4E8B;&#x52A1;&#x65E5;&#x5FD7;&#x4E2D;&#xFF09;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x3001;NO&#x6216;&#x8005;&#x8D85;&#x65F6;</li>\n<li>&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x9636;&#x6BB5;<br>&#x5F53;&#x9636;&#x6BB5;&#x4E00;&#x6240;&#x6709;&#x7684;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;ACK&#x6D88;&#x606F;&#xFF0C;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x9636;&#x6BB5;&#xFF1A;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x672C;&#x5730;&#x63D0;&#x4EA4;&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x6D88;&#x606F;&#x2013;&gt;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;<br>&#x5F53;&#x9636;&#x6BB5;&#x4E00;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;NO&#x6D88;&#x606F;&#x6216;&#x8005;&#x90E8;&#x5206;&#x6267;&#x884C;&#x8D85;&#x65F6;&#xFF0C;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x56DE;&#x6EDA;&#x9636;&#x6BB5;&#xFF1A;<br>&#x534F;&#x8C03;&#x8005;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;rollback&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x63D0;&#x4EA4;&#x672C;&#x5730;rollback&#x2013;&gt;&#x53C2;&#x4E0E;&#x8005;&#x8FD4;&#x56DE;&#x534F;&#x8C03;&#x8005;ACK&#x6D88;&#x606F;&#x2013;&gt;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#x3002;</li>\n</ul>\n<h3 id=\"2PC&#x4F18;&#x70B9;\"><a href=\"#2PC&#x4F18;&#x70B9;\" class=\"headerlink\" title=\"2PC&#x4F18;&#x70B9;\"></a>2PC&#x4F18;&#x70B9;</h3><ul>\n<li>&#x7B80;&#x5355;&#x660E;&#x4E86;&#xFF0C;&#x5B9E;&#x73B0;&#x65B9;&#x4FBF;&#x3002;</li>\n</ul>\n<h3 id=\"2PC&#x7F3A;&#x70B9;\"><a href=\"#2PC&#x7F3A;&#x70B9;\" class=\"headerlink\" title=\"2PC&#x7F3A;&#x70B9;\"></a>2PC&#x7F3A;&#x70B9;</h3><ul>\n<li>&#x540C;&#x6B65;&#x963B;&#x585E;&#xFF1A;<br>2PC&#x6700;&#x5927;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x540C;&#x6B65;&#x963B;&#x585E;&#xFF0C;&#x5C31;&#x662F;&#x5728;2&#x6B21;&#x9636;&#x6BB5;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x5B8C;&#x6210;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x53C2;&#x4E0E;&#x8005;&#x90FD;&#x662F;&#x963B;&#x585E;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x6765;&#x770B;&#x5C31;&#x662F;&#x5927;&#x90E8;&#x5206;&#x65F6;&#x95F4;&#x5728;&#x7B49;&#x5F85;&#x5176;&#x4ED6;&#x53C2;&#x4E0E;&#x8005;&#x7684;&#x54CD;&#x5E94;&#x800C;&#x4E0D;&#x662F;&#x771F;&#x6B63;&#x8FDB;&#x884C;&#x903B;&#x8F91;&#x8BA1;&#x7B97;&#x3002;</li>\n<li>&#x5355;&#x70B9;&#x95EE;&#x9898;<br>&#x5355;&#x70B9;&#x95EE;&#x9898;&#x5927;&#x95EE;&#x9898;&#x51FA;&#x5728;&#x534F;&#x8C03;&#x8005;&#x7684;&#x89D2;&#x8272;&#x4E0A;&#xFF0C;&#x5F53;&#x534F;&#x8C03;&#x8005;&#x6267;&#x884C;&#x672C;&#x5730;&#x4EFB;&#x52A1;&#x8FD8;&#x672A;&#x6765;&#x5F97;&#x53CA;&#x53D1;&#x51FA;commit&#x6216;&#x8005;rollback&#x6216;&#x8005;&#x53D1;&#x51FA;&#x90E8;&#x5206;&#x547D;&#x4EE4;&#xFF08;&#x53EA;&#x6709;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x6536;&#x5230;commit&#x6216;&#x8005;rollback&#x547D;&#x4EE4;&#xFF09;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x6574;&#x4E2A;2PC&#x9636;&#x6BB5;&#x5C31;&#x65E0;&#x6CD5;&#x8FD0;&#x8F6C;&#x751A;&#x81F3;&#x90E8;&#x5206;&#x53C2;&#x4E0E;&#x8005;&#x4E00;&#x76F4;&#x9501;&#x5B9A;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x603B;&#x6210;&#x6570;&#x636E;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x81F4;&#x3002;</li>\n<li>&#x592A;&#x8FC7;&#x4FDD;&#x5B88;<br>&#x5F53;&#x4EFB;&#x610F;&#x4E00;&#x53F0;&#x53C2;&#x4E0E;&#x8005;&#x56E0;&#x4E3A;&#x672C;&#x8EAB;&#x7684;&#x539F;&#x56E0;&#x5931;&#x8D25;&#x6216;&#x8005;&#x5B95;&#x673A;&#x6216;&#x9020;&#x6210;&#xFF0C;&#x534F;&#x8C03;&#x8005;&#x53EA;&#x80FD;&#x7B49;&#x5F85;&#x8D85;&#x65F6;&#xFF0C;&#x6CA1;&#x6709;&#x505A;&#x5230;&#x66F4;&#x597D;&#x7684;&#x65F6;&#x6548;&#x3002;&#x6574;&#x4E2A;&#x4E8B;&#x52A1;&#x6D41;&#x7A0B;&#x5168;&#x90E8;&#x5931;&#x8D25;&#xFF0C;&#x8FD9;&#x660E;&#x663E;&#x548C;&#x5206;&#x5E03;&#x5F0F;&#x8BBE;&#x8BA1;&#x7684;&#x521D;&#x8877;&#x6709;&#x504F;&#x5DEE;&#xFF0C;&#x5206;&#x5E03;&#x5F0F;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x7EFC;&#x5408;&#x6781;&#x901F;&#x80FD;&#x529B;&#x5E76;&#x4E14;&#x6781;&#x4F73;&#x7684;&#x6C34;&#x5E73;&#x6269;&#x7F29;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BB9;&#x9519;&#x8BBE;&#x8BA1;&#x662F;&#x975E;&#x5E38;&#x4FDD;&#x5B88;&#x7684;&#x3002;</li>\n</ul>\n"},{"title":"LVS四层负载均衡","date":"2016-12-28T09:47:26.000Z","_content":">## 四层负载均衡\n四层负载均衡指的是在即在OSI第4层工作，就是TCP层，一般使用的LVS的IP负载均衡；每个LVS中的负载均衡服务器都有一个IP一般称为VIP，而用户对服务请求必须基于对此VIP进行访问。\n\n>#### 当用户的请求到达VIP如何分配到RealServer上的，此处有3种实现分别是NAT、TUN和DR。\n>### NAT： 即（Virtual Server via Network Address Translation）\n网络翻译技术实现虚拟服务器，当用户的请求到达VIP Server的时候，VIP Server根据一定的负载均衡策略，修改报文的目的IP和端口为Real Server，而Real Server做出相应之后，将报文返回VIP Server，VIP 修改报文的源地址从Real Server改为VIP Server 发给Client。从上面过程中流量的进入和方位全部需要经过VIP Server重写，所以存在VIP Server的瓶颈。\n>### TUN ：即（Virtual Server via IP Tunneling）\nIP隧道技术实现虚拟服务器， 和NAT技术相似流量进入并转发给Real Server链路是相同的，不同的是Real Server返回直接范围Client不经过前端VIP Server，此方式VIP Server将只处理进入的流量，集群系统的吞吐量大大提高。\n>### DR： 即（Virtual Server via Direct Routing） \n直接路由实现虚拟服务器，它的思路和TUN技术比较相似，当时在用户进入的流量转发到Real Server的时候不是采用IP进行转发的，而是根据mac地址，直接修改数据包的mac的地址，相应报文也是直接返回给Client。(DR模式下需要LVS和绑定同一个VIP,通过loopback实现)这种方式是3种方式中效率最高的，但是它是基于mac转发的，限制VIP Server与Real Server都有一块网卡连在同一物理网段上。\n\n>### 总括\n负载均衡系统必须建立在面对网络连接的基础上，而不是面对数据包的基础上。也就是说网络连接是有状态，A数据包和后续B数据报很可能是有关联，比如TCP的三次握手，软负载面向的对象应该是一个已经建立连接的用户，而不是一个孤零零的IP包。所以说在第一次对某Client的流量选定了后端服务器之后，一定记录出先转发的路由表，在一定时间的范围内保证保持Client和后端服务器连接关联性。为了确保这一点，LVS内部维护着一个Session的Hash表，通过客户端的某些信息可以找到应该转发到哪一台Real Server上。\n","source":"_posts/LVS四层负载均衡.md","raw":"---\ntitle: LVS四层负载均衡\ndate: 2016-12-28 17:47:26\ntags: Net\n---\n>## 四层负载均衡\n四层负载均衡指的是在即在OSI第4层工作，就是TCP层，一般使用的LVS的IP负载均衡；每个LVS中的负载均衡服务器都有一个IP一般称为VIP，而用户对服务请求必须基于对此VIP进行访问。\n\n>#### 当用户的请求到达VIP如何分配到RealServer上的，此处有3种实现分别是NAT、TUN和DR。\n>### NAT： 即（Virtual Server via Network Address Translation）\n网络翻译技术实现虚拟服务器，当用户的请求到达VIP Server的时候，VIP Server根据一定的负载均衡策略，修改报文的目的IP和端口为Real Server，而Real Server做出相应之后，将报文返回VIP Server，VIP 修改报文的源地址从Real Server改为VIP Server 发给Client。从上面过程中流量的进入和方位全部需要经过VIP Server重写，所以存在VIP Server的瓶颈。\n>### TUN ：即（Virtual Server via IP Tunneling）\nIP隧道技术实现虚拟服务器， 和NAT技术相似流量进入并转发给Real Server链路是相同的，不同的是Real Server返回直接范围Client不经过前端VIP Server，此方式VIP Server将只处理进入的流量，集群系统的吞吐量大大提高。\n>### DR： 即（Virtual Server via Direct Routing） \n直接路由实现虚拟服务器，它的思路和TUN技术比较相似，当时在用户进入的流量转发到Real Server的时候不是采用IP进行转发的，而是根据mac地址，直接修改数据包的mac的地址，相应报文也是直接返回给Client。(DR模式下需要LVS和绑定同一个VIP,通过loopback实现)这种方式是3种方式中效率最高的，但是它是基于mac转发的，限制VIP Server与Real Server都有一块网卡连在同一物理网段上。\n\n>### 总括\n负载均衡系统必须建立在面对网络连接的基础上，而不是面对数据包的基础上。也就是说网络连接是有状态，A数据包和后续B数据报很可能是有关联，比如TCP的三次握手，软负载面向的对象应该是一个已经建立连接的用户，而不是一个孤零零的IP包。所以说在第一次对某Client的流量选定了后端服务器之后，一定记录出先转发的路由表，在一定时间的范围内保证保持Client和后端服务器连接关联性。为了确保这一点，LVS内部维护着一个Session的Hash表，通过客户端的某些信息可以找到应该转发到哪一台Real Server上。\n","slug":"LVS四层负载均衡","published":1,"updated":"2016-12-28T12:07:36.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cixq3mp9e0002ez0t3g0parex","content":"<blockquote>\n<h2 id=\"&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\"><a href=\"#&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\" class=\"headerlink\" title=\"&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\"></a>&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;</h2><p>&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x6307;&#x7684;&#x662F;&#x5728;&#x5373;&#x5728;OSI&#x7B2C;4&#x5C42;&#x5DE5;&#x4F5C;&#xFF0C;&#x5C31;&#x662F;TCP&#x5C42;&#xFF0C;&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x7684;LVS&#x7684;IP&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF1B;&#x6BCF;&#x4E2A;LVS&#x4E2D;&#x7684;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x670D;&#x52A1;&#x5668;&#x90FD;&#x6709;&#x4E00;&#x4E2A;IP&#x4E00;&#x822C;&#x79F0;&#x4E3A;VIP&#xFF0C;&#x800C;&#x7528;&#x6237;&#x5BF9;&#x670D;&#x52A1;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x57FA;&#x4E8E;&#x5BF9;&#x6B64;VIP&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x3002;</p>\n<h4 id=\"&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\"><a href=\"#&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\" class=\"headerlink\" title=\"&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\"></a>&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;</h4><h3 id=\"NAT&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Network-Address-Translation&#xFF09;\"><a href=\"#NAT&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Network-Address-Translation&#xFF09;\" class=\"headerlink\" title=\"NAT&#xFF1A; &#x5373;&#xFF08;Virtual Server via Network Address Translation&#xFF09;\"></a>NAT&#xFF1A; &#x5373;&#xFF08;Virtual Server via Network Address Translation&#xFF09;</h3><p>&#x7F51;&#x7EDC;&#x7FFB;&#x8BD1;&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP Server&#x7684;&#x65F6;&#x5019;&#xFF0C;VIP Server&#x6839;&#x636E;&#x4E00;&#x5B9A;&#x7684;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7B56;&#x7565;&#xFF0C;&#x4FEE;&#x6539;&#x62A5;&#x6587;&#x7684;&#x76EE;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#x4E3A;Real Server&#xFF0C;&#x800C;Real Server&#x505A;&#x51FA;&#x76F8;&#x5E94;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x62A5;&#x6587;&#x8FD4;&#x56DE;VIP Server&#xFF0C;VIP &#x4FEE;&#x6539;&#x62A5;&#x6587;&#x7684;&#x6E90;&#x5730;&#x5740;&#x4ECE;Real Server&#x6539;&#x4E3A;VIP Server &#x53D1;&#x7ED9;Client&#x3002;&#x4ECE;&#x4E0A;&#x9762;&#x8FC7;&#x7A0B;&#x4E2D;&#x6D41;&#x91CF;&#x7684;&#x8FDB;&#x5165;&#x548C;&#x65B9;&#x4F4D;&#x5168;&#x90E8;&#x9700;&#x8981;&#x7ECF;&#x8FC7;VIP Server&#x91CD;&#x5199;&#xFF0C;&#x6240;&#x4EE5;&#x5B58;&#x5728;VIP Server&#x7684;&#x74F6;&#x9888;&#x3002;</p>\n<h3 id=\"TUN-&#xFF1A;&#x5373;&#xFF08;Virtual-Server-via-IP-Tunneling&#xFF09;\"><a href=\"#TUN-&#xFF1A;&#x5373;&#xFF08;Virtual-Server-via-IP-Tunneling&#xFF09;\" class=\"headerlink\" title=\"TUN &#xFF1A;&#x5373;&#xFF08;Virtual Server via IP Tunneling&#xFF09;\"></a>TUN &#xFF1A;&#x5373;&#xFF08;Virtual Server via IP Tunneling&#xFF09;</h3><p>IP&#x96A7;&#x9053;&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C; &#x548C;NAT&#x6280;&#x672F;&#x76F8;&#x4F3C;&#x6D41;&#x91CF;&#x8FDB;&#x5165;&#x5E76;&#x8F6C;&#x53D1;&#x7ED9;Real Server&#x94FE;&#x8DEF;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x662F;Real Server&#x8FD4;&#x56DE;&#x76F4;&#x63A5;&#x8303;&#x56F4;Client&#x4E0D;&#x7ECF;&#x8FC7;&#x524D;&#x7AEF;VIP Server&#xFF0C;&#x6B64;&#x65B9;&#x5F0F;VIP Server&#x5C06;&#x53EA;&#x5904;&#x7406;&#x8FDB;&#x5165;&#x7684;&#x6D41;&#x91CF;&#xFF0C;&#x96C6;&#x7FA4;&#x7CFB;&#x7EDF;&#x7684;&#x541E;&#x5410;&#x91CF;&#x5927;&#x5927;&#x63D0;&#x9AD8;&#x3002;</p>\n<h3 id=\"DR&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Direct-Routing&#xFF09;\"><a href=\"#DR&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Direct-Routing&#xFF09;\" class=\"headerlink\" title=\"DR&#xFF1A; &#x5373;&#xFF08;Virtual Server via Direct Routing&#xFF09;\"></a>DR&#xFF1A; &#x5373;&#xFF08;Virtual Server via Direct Routing&#xFF09;</h3><p>&#x76F4;&#x63A5;&#x8DEF;&#x7531;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5B83;&#x7684;&#x601D;&#x8DEF;&#x548C;TUN&#x6280;&#x672F;&#x6BD4;&#x8F83;&#x76F8;&#x4F3C;&#xFF0C;&#x5F53;&#x65F6;&#x5728;&#x7528;&#x6237;&#x8FDB;&#x5165;&#x7684;&#x6D41;&#x91CF;&#x8F6C;&#x53D1;&#x5230;Real Server&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x662F;&#x91C7;&#x7528;IP&#x8FDB;&#x884C;&#x8F6C;&#x53D1;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x6839;&#x636E;mac&#x5730;&#x5740;&#xFF0C;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5305;&#x7684;mac&#x7684;&#x5730;&#x5740;&#xFF0C;&#x76F8;&#x5E94;&#x62A5;&#x6587;&#x4E5F;&#x662F;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7ED9;Client&#x3002;(DR&#x6A21;&#x5F0F;&#x4E0B;&#x9700;&#x8981;LVS&#x548C;&#x7ED1;&#x5B9A;&#x540C;&#x4E00;&#x4E2A;VIP,&#x901A;&#x8FC7;loopback&#x5B9E;&#x73B0;)&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;3&#x79CD;&#x65B9;&#x5F0F;&#x4E2D;&#x6548;&#x7387;&#x6700;&#x9AD8;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x662F;&#x57FA;&#x4E8E;mac&#x8F6C;&#x53D1;&#x7684;&#xFF0C;&#x9650;&#x5236;VIP Server&#x4E0E;Real Server&#x90FD;&#x6709;&#x4E00;&#x5757;&#x7F51;&#x5361;&#x8FDE;&#x5728;&#x540C;&#x4E00;&#x7269;&#x7406;&#x7F51;&#x6BB5;&#x4E0A;&#x3002;</p>\n<h3 id=\"&#x603B;&#x62EC;\"><a href=\"#&#x603B;&#x62EC;\" class=\"headerlink\" title=\"&#x603B;&#x62EC;\"></a>&#x603B;&#x62EC;</h3><p>&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7CFB;&#x7EDF;&#x5FC5;&#x987B;&#x5EFA;&#x7ACB;&#x5728;&#x9762;&#x5BF9;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x9762;&#x5BF9;&#x6570;&#x636E;&#x5305;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x662F;&#x6709;&#x72B6;&#x6001;&#xFF0C;A&#x6570;&#x636E;&#x5305;&#x548C;&#x540E;&#x7EED;B&#x6570;&#x636E;&#x62A5;&#x5F88;&#x53EF;&#x80FD;&#x662F;&#x6709;&#x5173;&#x8054;&#xFF0C;&#x6BD4;&#x5982;TCP&#x7684;&#x4E09;&#x6B21;&#x63E1;&#x624B;&#xFF0C;&#x8F6F;&#x8D1F;&#x8F7D;&#x9762;&#x5411;&#x7684;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5B64;&#x96F6;&#x96F6;&#x7684;IP&#x5305;&#x3002;&#x6240;&#x4EE5;&#x8BF4;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x5BF9;&#x67D0;Client&#x7684;&#x6D41;&#x91CF;&#x9009;&#x5B9A;&#x4E86;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x540E;&#xFF0C;&#x4E00;&#x5B9A;&#x8BB0;&#x5F55;&#x51FA;&#x5148;&#x8F6C;&#x53D1;&#x7684;&#x8DEF;&#x7531;&#x8868;&#xFF0C;&#x5728;&#x4E00;&#x5B9A;&#x65F6;&#x95F4;&#x7684;&#x8303;&#x56F4;&#x5185;&#x4FDD;&#x8BC1;&#x4FDD;&#x6301;Client&#x548C;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x8FDE;&#x63A5;&#x5173;&#x8054;&#x6027;&#x3002;&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;LVS&#x5185;&#x90E8;&#x7EF4;&#x62A4;&#x7740;&#x4E00;&#x4E2A;Session&#x7684;Hash&#x8868;&#xFF0C;&#x901A;&#x8FC7;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x67D0;&#x4E9B;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5E94;&#x8BE5;&#x8F6C;&#x53D1;&#x5230;&#x54EA;&#x4E00;&#x53F0;Real Server&#x4E0A;&#x3002;</p>\n</blockquote>\n","excerpt":"","more":"<blockquote>\n<h2 id=\"&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\"><a href=\"#&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\" class=\"headerlink\" title=\"&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;\"></a>&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;</h2><p>&#x56DB;&#x5C42;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x6307;&#x7684;&#x662F;&#x5728;&#x5373;&#x5728;OSI&#x7B2C;4&#x5C42;&#x5DE5;&#x4F5C;&#xFF0C;&#x5C31;&#x662F;TCP&#x5C42;&#xFF0C;&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x7684;LVS&#x7684;IP&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF1B;&#x6BCF;&#x4E2A;LVS&#x4E2D;&#x7684;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x670D;&#x52A1;&#x5668;&#x90FD;&#x6709;&#x4E00;&#x4E2A;IP&#x4E00;&#x822C;&#x79F0;&#x4E3A;VIP&#xFF0C;&#x800C;&#x7528;&#x6237;&#x5BF9;&#x670D;&#x52A1;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x57FA;&#x4E8E;&#x5BF9;&#x6B64;VIP&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x3002;</p>\n<h4 id=\"&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\"><a href=\"#&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\" class=\"headerlink\" title=\"&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;\"></a>&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP&#x5982;&#x4F55;&#x5206;&#x914D;&#x5230;RealServer&#x4E0A;&#x7684;&#xFF0C;&#x6B64;&#x5904;&#x6709;3&#x79CD;&#x5B9E;&#x73B0;&#x5206;&#x522B;&#x662F;NAT&#x3001;TUN&#x548C;DR&#x3002;</h4><h3 id=\"NAT&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Network-Address-Translation&#xFF09;\"><a href=\"#NAT&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Network-Address-Translation&#xFF09;\" class=\"headerlink\" title=\"NAT&#xFF1A; &#x5373;&#xFF08;Virtual Server via Network Address Translation&#xFF09;\"></a>NAT&#xFF1A; &#x5373;&#xFF08;Virtual Server via Network Address Translation&#xFF09;</h3><p>&#x7F51;&#x7EDC;&#x7FFB;&#x8BD1;&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;VIP Server&#x7684;&#x65F6;&#x5019;&#xFF0C;VIP Server&#x6839;&#x636E;&#x4E00;&#x5B9A;&#x7684;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7B56;&#x7565;&#xFF0C;&#x4FEE;&#x6539;&#x62A5;&#x6587;&#x7684;&#x76EE;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#x4E3A;Real Server&#xFF0C;&#x800C;Real Server&#x505A;&#x51FA;&#x76F8;&#x5E94;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x62A5;&#x6587;&#x8FD4;&#x56DE;VIP Server&#xFF0C;VIP &#x4FEE;&#x6539;&#x62A5;&#x6587;&#x7684;&#x6E90;&#x5730;&#x5740;&#x4ECE;Real Server&#x6539;&#x4E3A;VIP Server &#x53D1;&#x7ED9;Client&#x3002;&#x4ECE;&#x4E0A;&#x9762;&#x8FC7;&#x7A0B;&#x4E2D;&#x6D41;&#x91CF;&#x7684;&#x8FDB;&#x5165;&#x548C;&#x65B9;&#x4F4D;&#x5168;&#x90E8;&#x9700;&#x8981;&#x7ECF;&#x8FC7;VIP Server&#x91CD;&#x5199;&#xFF0C;&#x6240;&#x4EE5;&#x5B58;&#x5728;VIP Server&#x7684;&#x74F6;&#x9888;&#x3002;</p>\n<h3 id=\"TUN-&#xFF1A;&#x5373;&#xFF08;Virtual-Server-via-IP-Tunneling&#xFF09;\"><a href=\"#TUN-&#xFF1A;&#x5373;&#xFF08;Virtual-Server-via-IP-Tunneling&#xFF09;\" class=\"headerlink\" title=\"TUN &#xFF1A;&#x5373;&#xFF08;Virtual Server via IP Tunneling&#xFF09;\"></a>TUN &#xFF1A;&#x5373;&#xFF08;Virtual Server via IP Tunneling&#xFF09;</h3><p>IP&#x96A7;&#x9053;&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C; &#x548C;NAT&#x6280;&#x672F;&#x76F8;&#x4F3C;&#x6D41;&#x91CF;&#x8FDB;&#x5165;&#x5E76;&#x8F6C;&#x53D1;&#x7ED9;Real Server&#x94FE;&#x8DEF;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x662F;Real Server&#x8FD4;&#x56DE;&#x76F4;&#x63A5;&#x8303;&#x56F4;Client&#x4E0D;&#x7ECF;&#x8FC7;&#x524D;&#x7AEF;VIP Server&#xFF0C;&#x6B64;&#x65B9;&#x5F0F;VIP Server&#x5C06;&#x53EA;&#x5904;&#x7406;&#x8FDB;&#x5165;&#x7684;&#x6D41;&#x91CF;&#xFF0C;&#x96C6;&#x7FA4;&#x7CFB;&#x7EDF;&#x7684;&#x541E;&#x5410;&#x91CF;&#x5927;&#x5927;&#x63D0;&#x9AD8;&#x3002;</p>\n<h3 id=\"DR&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Direct-Routing&#xFF09;\"><a href=\"#DR&#xFF1A;-&#x5373;&#xFF08;Virtual-Server-via-Direct-Routing&#xFF09;\" class=\"headerlink\" title=\"DR&#xFF1A; &#x5373;&#xFF08;Virtual Server via Direct Routing&#xFF09;\"></a>DR&#xFF1A; &#x5373;&#xFF08;Virtual Server via Direct Routing&#xFF09;</h3><p>&#x76F4;&#x63A5;&#x8DEF;&#x7531;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5B83;&#x7684;&#x601D;&#x8DEF;&#x548C;TUN&#x6280;&#x672F;&#x6BD4;&#x8F83;&#x76F8;&#x4F3C;&#xFF0C;&#x5F53;&#x65F6;&#x5728;&#x7528;&#x6237;&#x8FDB;&#x5165;&#x7684;&#x6D41;&#x91CF;&#x8F6C;&#x53D1;&#x5230;Real Server&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x662F;&#x91C7;&#x7528;IP&#x8FDB;&#x884C;&#x8F6C;&#x53D1;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x6839;&#x636E;mac&#x5730;&#x5740;&#xFF0C;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5305;&#x7684;mac&#x7684;&#x5730;&#x5740;&#xFF0C;&#x76F8;&#x5E94;&#x62A5;&#x6587;&#x4E5F;&#x662F;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7ED9;Client&#x3002;(DR&#x6A21;&#x5F0F;&#x4E0B;&#x9700;&#x8981;LVS&#x548C;&#x7ED1;&#x5B9A;&#x540C;&#x4E00;&#x4E2A;VIP,&#x901A;&#x8FC7;loopback&#x5B9E;&#x73B0;)&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;3&#x79CD;&#x65B9;&#x5F0F;&#x4E2D;&#x6548;&#x7387;&#x6700;&#x9AD8;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x662F;&#x57FA;&#x4E8E;mac&#x8F6C;&#x53D1;&#x7684;&#xFF0C;&#x9650;&#x5236;VIP Server&#x4E0E;Real Server&#x90FD;&#x6709;&#x4E00;&#x5757;&#x7F51;&#x5361;&#x8FDE;&#x5728;&#x540C;&#x4E00;&#x7269;&#x7406;&#x7F51;&#x6BB5;&#x4E0A;&#x3002;</p>\n<h3 id=\"&#x603B;&#x62EC;\"><a href=\"#&#x603B;&#x62EC;\" class=\"headerlink\" title=\"&#x603B;&#x62EC;\"></a>&#x603B;&#x62EC;</h3><p>&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7CFB;&#x7EDF;&#x5FC5;&#x987B;&#x5EFA;&#x7ACB;&#x5728;&#x9762;&#x5BF9;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x9762;&#x5BF9;&#x6570;&#x636E;&#x5305;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x662F;&#x6709;&#x72B6;&#x6001;&#xFF0C;A&#x6570;&#x636E;&#x5305;&#x548C;&#x540E;&#x7EED;B&#x6570;&#x636E;&#x62A5;&#x5F88;&#x53EF;&#x80FD;&#x662F;&#x6709;&#x5173;&#x8054;&#xFF0C;&#x6BD4;&#x5982;TCP&#x7684;&#x4E09;&#x6B21;&#x63E1;&#x624B;&#xFF0C;&#x8F6F;&#x8D1F;&#x8F7D;&#x9762;&#x5411;&#x7684;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5B64;&#x96F6;&#x96F6;&#x7684;IP&#x5305;&#x3002;&#x6240;&#x4EE5;&#x8BF4;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x5BF9;&#x67D0;Client&#x7684;&#x6D41;&#x91CF;&#x9009;&#x5B9A;&#x4E86;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x540E;&#xFF0C;&#x4E00;&#x5B9A;&#x8BB0;&#x5F55;&#x51FA;&#x5148;&#x8F6C;&#x53D1;&#x7684;&#x8DEF;&#x7531;&#x8868;&#xFF0C;&#x5728;&#x4E00;&#x5B9A;&#x65F6;&#x95F4;&#x7684;&#x8303;&#x56F4;&#x5185;&#x4FDD;&#x8BC1;&#x4FDD;&#x6301;Client&#x548C;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x5668;&#x8FDE;&#x63A5;&#x5173;&#x8054;&#x6027;&#x3002;&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;LVS&#x5185;&#x90E8;&#x7EF4;&#x62A4;&#x7740;&#x4E00;&#x4E2A;Session&#x7684;Hash&#x8868;&#xFF0C;&#x901A;&#x8FC7;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x67D0;&#x4E9B;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5E94;&#x8BE5;&#x8F6C;&#x53D1;&#x5230;&#x54EA;&#x4E00;&#x53F0;Real Server&#x4E0A;&#x3002;</p>\n</blockquote>\n"},{"title":"Java自定义Class加载顺序","date":"2016-12-28T12:47:26.000Z","_content":"\n在Java中默认的Class加载顺序都是父类委托加载，但是有些时候需要自定义加载顺序比如OSGI和阿里的Pandora。\n其中最常见的问题是有2个一模一样的类，到底加运行哪一个。\n\n### 打破双亲加载\n\n* 父类委托加载的基本实现思路，loadClass首先委托给parent中查找class要是找不到，再使用本身的classLoader去寻找，所以默认的顺序基本上是从上向下找。\n\n* 普通自定义classLoader只是重写findClass去加载自己路径下的class。但是要想打破父类委托机制去自定义前后顺序去加载class就要完全自己去实现loadClass方法控制加载顺序，不是首先委派给parent而是在自己返回或者查找持有的其他classLoader中的类。\n\n### 设计自己的ClassLoader\n* 基本思路就是，自定义classLoader，然后将自定义的classLoader设置为extClassLoader以下所有classLoader的parent，然后利用双亲加载（除去jdk class）其他的class就会加载自己的class，此ClassLoader已经是appClassLoader中最顶层的ClassLoader了，所有冲突的类都会运行其中实现，防止了类冲突的问题。\n","source":"_posts/overrideclassloader.md","raw":"---\ntitle: Java自定义Class加载顺序\ndate: 2016-12-28 20:47:26\ntags: Java\n---\n\n在Java中默认的Class加载顺序都是父类委托加载，但是有些时候需要自定义加载顺序比如OSGI和阿里的Pandora。\n其中最常见的问题是有2个一模一样的类，到底加运行哪一个。\n\n### 打破双亲加载\n\n* 父类委托加载的基本实现思路，loadClass首先委托给parent中查找class要是找不到，再使用本身的classLoader去寻找，所以默认的顺序基本上是从上向下找。\n\n* 普通自定义classLoader只是重写findClass去加载自己路径下的class。但是要想打破父类委托机制去自定义前后顺序去加载class就要完全自己去实现loadClass方法控制加载顺序，不是首先委派给parent而是在自己返回或者查找持有的其他classLoader中的类。\n\n### 设计自己的ClassLoader\n* 基本思路就是，自定义classLoader，然后将自定义的classLoader设置为extClassLoader以下所有classLoader的parent，然后利用双亲加载（除去jdk class）其他的class就会加载自己的class，此ClassLoader已经是appClassLoader中最顶层的ClassLoader了，所有冲突的类都会运行其中实现，防止了类冲突的问题。\n","slug":"overrideclassloader","published":1,"updated":"2017-01-05T03:11:43.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cixq3mp9p0004ez0tylop7x2r","content":"<p>&#x5728;Java&#x4E2D;&#x9ED8;&#x8BA4;&#x7684;Class&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x90FD;&#x662F;&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x52A0;&#x8F7D;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x6BD4;&#x5982;OSGI&#x548C;&#x963F;&#x91CC;&#x7684;Pandora&#x3002;<br>&#x5176;&#x4E2D;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x95EE;&#x9898;&#x662F;&#x6709;2&#x4E2A;&#x4E00;&#x6A21;&#x4E00;&#x6837;&#x7684;&#x7C7B;&#xFF0C;&#x5230;&#x5E95;&#x52A0;&#x8FD0;&#x884C;&#x54EA;&#x4E00;&#x4E2A;&#x3002;</p>\n<h3 id=\"&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\"><a href=\"#&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\" class=\"headerlink\" title=\"&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\"></a>&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;</h3><ul>\n<li><p>&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x52A0;&#x8F7D;&#x7684;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#xFF0C;loadClass&#x9996;&#x5148;&#x59D4;&#x6258;&#x7ED9;parent&#x4E2D;&#x67E5;&#x627E;class&#x8981;&#x662F;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x518D;&#x4F7F;&#x7528;&#x672C;&#x8EAB;&#x7684;classLoader&#x53BB;&#x5BFB;&#x627E;&#xFF0C;&#x6240;&#x4EE5;&#x9ED8;&#x8BA4;&#x7684;&#x987A;&#x5E8F;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x4ECE;&#x4E0A;&#x5411;&#x4E0B;&#x627E;&#x3002;</p>\n</li>\n<li><p>&#x666E;&#x901A;&#x81EA;&#x5B9A;&#x4E49;classLoader&#x53EA;&#x662F;&#x91CD;&#x5199;findClass&#x53BB;&#x52A0;&#x8F7D;&#x81EA;&#x5DF1;&#x8DEF;&#x5F84;&#x4E0B;&#x7684;class&#x3002;&#x4F46;&#x662F;&#x8981;&#x60F3;&#x6253;&#x7834;&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x673A;&#x5236;&#x53BB;&#x81EA;&#x5B9A;&#x4E49;&#x524D;&#x540E;&#x987A;&#x5E8F;&#x53BB;&#x52A0;&#x8F7D;class&#x5C31;&#x8981;&#x5B8C;&#x5168;&#x81EA;&#x5DF1;&#x53BB;&#x5B9E;&#x73B0;loadClass&#x65B9;&#x6CD5;&#x63A7;&#x5236;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#xFF0C;&#x4E0D;&#x662F;&#x9996;&#x5148;&#x59D4;&#x6D3E;&#x7ED9;parent&#x800C;&#x662F;&#x5728;&#x81EA;&#x5DF1;&#x8FD4;&#x56DE;&#x6216;&#x8005;&#x67E5;&#x627E;&#x6301;&#x6709;&#x7684;&#x5176;&#x4ED6;classLoader&#x4E2D;&#x7684;&#x7C7B;&#x3002;</p>\n</li>\n</ul>\n<h3 id=\"&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\"><a href=\"#&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\" class=\"headerlink\" title=\"&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\"></a>&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader</h3><ul>\n<li>&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;classLoader&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;classLoader&#x8BBE;&#x7F6E;&#x4E3A;extClassLoader&#x4EE5;&#x4E0B;&#x6240;&#x6709;classLoader&#x7684;parent&#xFF0C;&#x7136;&#x540E;&#x5229;&#x7528;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;&#xFF08;&#x9664;&#x53BB;jdk class&#xFF09;&#x5176;&#x4ED6;&#x7684;class&#x5C31;&#x4F1A;&#x52A0;&#x8F7D;&#x81EA;&#x5DF1;&#x7684;class&#xFF0C;&#x6B64;ClassLoader&#x5DF2;&#x7ECF;&#x662F;appClassLoader&#x4E2D;&#x6700;&#x9876;&#x5C42;&#x7684;ClassLoader&#x4E86;&#xFF0C;&#x6240;&#x6709;&#x51B2;&#x7A81;&#x7684;&#x7C7B;&#x90FD;&#x4F1A;&#x8FD0;&#x884C;&#x5176;&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x9632;&#x6B62;&#x4E86;&#x7C7B;&#x51B2;&#x7A81;&#x7684;&#x95EE;&#x9898;&#x3002;</li>\n</ul>\n","excerpt":"","more":"<p>&#x5728;Java&#x4E2D;&#x9ED8;&#x8BA4;&#x7684;Class&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x90FD;&#x662F;&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x52A0;&#x8F7D;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x6BD4;&#x5982;OSGI&#x548C;&#x963F;&#x91CC;&#x7684;Pandora&#x3002;<br>&#x5176;&#x4E2D;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x95EE;&#x9898;&#x662F;&#x6709;2&#x4E2A;&#x4E00;&#x6A21;&#x4E00;&#x6837;&#x7684;&#x7C7B;&#xFF0C;&#x5230;&#x5E95;&#x52A0;&#x8FD0;&#x884C;&#x54EA;&#x4E00;&#x4E2A;&#x3002;</p>\n<h3 id=\"&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\"><a href=\"#&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\" class=\"headerlink\" title=\"&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;\"></a>&#x6253;&#x7834;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;</h3><ul>\n<li><p>&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x52A0;&#x8F7D;&#x7684;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#xFF0C;loadClass&#x9996;&#x5148;&#x59D4;&#x6258;&#x7ED9;parent&#x4E2D;&#x67E5;&#x627E;class&#x8981;&#x662F;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x518D;&#x4F7F;&#x7528;&#x672C;&#x8EAB;&#x7684;classLoader&#x53BB;&#x5BFB;&#x627E;&#xFF0C;&#x6240;&#x4EE5;&#x9ED8;&#x8BA4;&#x7684;&#x987A;&#x5E8F;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x4ECE;&#x4E0A;&#x5411;&#x4E0B;&#x627E;&#x3002;</p>\n</li>\n<li><p>&#x666E;&#x901A;&#x81EA;&#x5B9A;&#x4E49;classLoader&#x53EA;&#x662F;&#x91CD;&#x5199;findClass&#x53BB;&#x52A0;&#x8F7D;&#x81EA;&#x5DF1;&#x8DEF;&#x5F84;&#x4E0B;&#x7684;class&#x3002;&#x4F46;&#x662F;&#x8981;&#x60F3;&#x6253;&#x7834;&#x7236;&#x7C7B;&#x59D4;&#x6258;&#x673A;&#x5236;&#x53BB;&#x81EA;&#x5B9A;&#x4E49;&#x524D;&#x540E;&#x987A;&#x5E8F;&#x53BB;&#x52A0;&#x8F7D;class&#x5C31;&#x8981;&#x5B8C;&#x5168;&#x81EA;&#x5DF1;&#x53BB;&#x5B9E;&#x73B0;loadClass&#x65B9;&#x6CD5;&#x63A7;&#x5236;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#xFF0C;&#x4E0D;&#x662F;&#x9996;&#x5148;&#x59D4;&#x6D3E;&#x7ED9;parent&#x800C;&#x662F;&#x5728;&#x81EA;&#x5DF1;&#x8FD4;&#x56DE;&#x6216;&#x8005;&#x67E5;&#x627E;&#x6301;&#x6709;&#x7684;&#x5176;&#x4ED6;classLoader&#x4E2D;&#x7684;&#x7C7B;&#x3002;</p>\n</li>\n</ul>\n<h3 id=\"&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\"><a href=\"#&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\" class=\"headerlink\" title=\"&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader\"></a>&#x8BBE;&#x8BA1;&#x81EA;&#x5DF1;&#x7684;ClassLoader</h3><ul>\n<li>&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;classLoader&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;classLoader&#x8BBE;&#x7F6E;&#x4E3A;extClassLoader&#x4EE5;&#x4E0B;&#x6240;&#x6709;classLoader&#x7684;parent&#xFF0C;&#x7136;&#x540E;&#x5229;&#x7528;&#x53CC;&#x4EB2;&#x52A0;&#x8F7D;&#xFF08;&#x9664;&#x53BB;jdk class&#xFF09;&#x5176;&#x4ED6;&#x7684;class&#x5C31;&#x4F1A;&#x52A0;&#x8F7D;&#x81EA;&#x5DF1;&#x7684;class&#xFF0C;&#x6B64;ClassLoader&#x5DF2;&#x7ECF;&#x662F;appClassLoader&#x4E2D;&#x6700;&#x9876;&#x5C42;&#x7684;ClassLoader&#x4E86;&#xFF0C;&#x6240;&#x6709;&#x51B2;&#x7A81;&#x7684;&#x7C7B;&#x90FD;&#x4F1A;&#x8FD0;&#x884C;&#x5176;&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x9632;&#x6B62;&#x4E86;&#x7C7B;&#x51B2;&#x7A81;&#x7684;&#x95EE;&#x9898;&#x3002;</li>\n</ul>\n"},{"title":"Protocol Buffer Java 实例","date":"2017-01-05T03:04:09.000Z","_content":"Protocol Buffer 是Google一款序列化的方案。序列化是网络传输的基础，在现阶段分布式使用愈加广泛的背景下，高效的序列化方案是必须的。比如Rpc，Netty都有基于protocol buffer的实现。\n今天写个简单的实例，看一下开发的全过程。\n\n### 编写proto文件\n  proto文件就是序列化的模板结构，后续proto编译器能够根据用户编写的模板文件生成相应的java类。\n  proto文件是静态的，只需要描述文件结构就可以相当于贫血模式的代码；后续生成的java文件会自动生成，get/set/build/parse等Protocol Buffer解析的方法，相当于充血模式，通过这种方式用户就不必理解Protocol Buffer的解析规范去实现相应的方法，主需关注自己要序列化的结构。\n  ```\n  package bs.maven.test.protobuf;\n  option java_package = \"bs.maven.test.protobuf\";\n  option java_outer_classname = \"AddressBookProtos\";\n  \n  message Person {\n    required string name = 1;\n    required int32 id = 2;\n    optional string email = 3;\n  \n    enum PhoneType {\n      MOBILE = 0;\n      HOME = 1;\n      WORK = 2;\n    }\n  \n    message PhoneNumber {\n      required string number = 1;\n      optional PhoneType type = 2 [default = HOME];\n    }\n  \n    repeated PhoneNumber phone = 4;\n  }\n  \n  message AddressBook {\n    repeated Person person = 1;\n  }\n  ```\n### 编译proto文件\n```\n  protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto\n```\n[Mac上protoc编译器的安装参看](http://my.oschina.net/KingPan/blog/283881?fromerr=8vajR5S9)\n\n### 使用proto文件\n\n  将生成的AddressBookProtos代码直接拷贝到相应的目录就可以直接开发。以文件的方式表示序列化过程，网络传输同理。\n  * 工程Maven 依赖：\n  ```\n  <dependency>\n\t\t\t<groupId>com.google.protobuf</groupId>\n\t\t\t<artifactId>protobuf-java</artifactId>\n\t\t\t<version>2.5.0</version>\n\t\t</dependency>\n  ```\n  * 实例代码\n  ```\n  public class AddressTest {\n\n\tprivate static final String fileName = \"/Users/bianshuai/Documents/tmp/protobuf/address\";\n\n\tpublic static void main(String[] args) {\n\t\twrite();\n\t\tread();\n\t}\n\n\tpublic static void write() {\n\n\t\tAddressBookProtos.Person john = Person.newBuilder().setId(1234).setName(\"John Doe\").setEmail(\"jdoe@example.com\")\n\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(\"555-4321\").setType(Person.PhoneType.HOME)).build();\n\n\t\tAddressBookProtos.Person gavin = Person.newBuilder().setId(12345).setName(\"gavin Doe\")\n\t\t\t\t.setEmail(\"gavin@example.com\")\n\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(\"555-4323\").setType(Person.PhoneType.HOME)).build();\n\n\t\tAddressBookProtos.AddressBook address = AddressBookProtos.AddressBook.newBuilder().addPerson(john)\n\t\t\t\t.addPerson(gavin).build();\n\t\tFileOutputStream output = null;\n\t\ttry {\n\t\t\toutput = new FileOutputStream(\"fileName\");\n\t\t\taddress.writeTo(output);\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tif (null != output) {\n\t\t\t\ttry {\n\t\t\t\t\toutput.close();\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void read() {\n\t\tAddressBook addressBook;\n\t\ttry {\n\t\t\taddressBook = AddressBook.parseFrom(new FileInputStream(fileName));\n\t\t\tPrint(addressBook);\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n\tstatic void Print(AddressBook addressBook) {\n\t\tfor (Person person : addressBook.getPersonList()) {\n\t\t\tSystem.out.println(\"Person ID: \" + person.getId());\n\t\t\tSystem.out.println(\"  Name: \" + person.getName());\n\t\t\tif (person.hasEmail()) {\n\t\t\t\tSystem.out.println(\"  E-mail address: \" + person.getEmail());\n\t\t\t}\n\n\t\t\tfor (Person.PhoneNumber phoneNumber : person.getPhoneList()) {\n\t\t\t\tswitch (phoneNumber.getType()) {\n\t\t\t\tcase MOBILE:\n\t\t\t\t\tSystem.out.print(\"  Mobile phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\tcase HOME:\n\t\t\t\t\tSystem.out.print(\"  Home phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\tcase WORK:\n\t\t\t\t\tSystem.out.print(\"  Work phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tSystem.out.println(phoneNumber.getNumber());\n\t\t\t}\n\t\t}\n\t}\n}\n  ```\n  \n### proto文件简单语法分析\n参考Google开发文档(https://developers.google.com/protocol-buffers/docs/proto)\n\n> .proto文件起始于一个包声明，这能够帮助在不同的工程中避免命名冲突。在使用Java的情况下，package name被用来作为Java的package，除非你详细指定了一个java_package，正如我们在这里是这样做的。即使你却是提供了一个java_package，你也应该仍旧定义一个正常的package以便在Protocol Buffers命名空间和非Java语言中避免命名冲突。\n\n> 在包声明以后，你会看到两个Java特有的配置项：java_package和java_outer_classname。java_package指定你生成的类要存在于什么包下。如果你没有具体的指定，它会简单的与package给出的package name相匹配，但是这些名字通常不适合做为Java包的名字（因为它们通常不以域名开头）。java_outer_classname配置项定义了那些在这个文件中包含所有类的名称。如果你没有具体指定java_outer_classname，它将会转换文件名为驼峰式来产生。例如，“my_proto.proto”将默认使用“MyProto”做为outer class name(类的文件名)。\n\n> 接下来是你的message定义。一个message只是一系列具有类型的域的集合。许多标准的简单类型可以做为可用的域类型，包括bool, int32, float, double, 和string。你同样可以向你的message中添加更多的结构，通过把其他的message类型当做域类型使用－－在上面的例子中，Person message包含PhoneNumber message，而AddressBook message包含Person message。你甚至可以通过内部嵌套其它message的方式定义message，你可以看到，PhoneNumber类型被定义在Person里面。你同样可以定义enum类型，如果你希望其中的一个你的域拥有预定义列表中的一个值－－在这里，你希望指定一个phone number的值是MOBILE, HOME, 或者WORK中的一个。\n\n> 这里在每个元素上面的“=1”，“=2”标记，辨识唯一的“tag”，这些“tag”是域在二进制编码的时候使用的。Tag编号从1到15，需要比更大的数字少一个字节，因此，出于优化考虑你可以决定使用常用的或者重复的元素。而从16到更高的编号留给不常用的可选元素。在重复域中的每一个元素都需要重新编码tag number，所以，使用重复域对优化来说是特别好的选择。\n\n> 每一个域都必须被下面之一的modifer注解：\n* required：域的值必须被提供，否则message会被认为是“未初始化的”。试图创建一个未初始化的message将会抛出一个RuntimeException。转化一个未初始化的message将会抛出一个IOException。除了这些，required域的行为和optional域表现相同。\n* optional：该域可能被设置，也可能未被设置。如果一个optional域未被设置，默认的值将会被使用。对于简单类型来说，你可以指定你自己的默认值，就像我们在例子中对phone number类型所做的那样。否则，一个系统默认的值将被使用：数值类型是0，字符串类型是\"\"，布尔类型是false。对于嵌入式的message来说，默认值总是这个message的没有任何域被设置过的“默认实例”或“原型”。调用访问器去获取一个optional或者required域的值，这些域如果没有被具体设置，那么总是返回域的默认值。\n* repeated：域将会被重复任意次数（包括0次）。重复的值的顺序将会被保存在protocol buffer中。可以把重复的域想成变长的数组。 \n  \n  \n### 总结\n最近查看一个开源p2p项目的代码，其中指令协议本身是已经固定好的，十分适合使用Protocol Buffer作为协议命令传输。\n","source":"_posts/protocol-buffer-demo.md","raw":"---\ntitle: Protocol Buffer Java 实例\ndate: 2017-01-05 11:04:09\ntags: Protocol Buffer\n---\nProtocol Buffer 是Google一款序列化的方案。序列化是网络传输的基础，在现阶段分布式使用愈加广泛的背景下，高效的序列化方案是必须的。比如Rpc，Netty都有基于protocol buffer的实现。\n今天写个简单的实例，看一下开发的全过程。\n\n### 编写proto文件\n  proto文件就是序列化的模板结构，后续proto编译器能够根据用户编写的模板文件生成相应的java类。\n  proto文件是静态的，只需要描述文件结构就可以相当于贫血模式的代码；后续生成的java文件会自动生成，get/set/build/parse等Protocol Buffer解析的方法，相当于充血模式，通过这种方式用户就不必理解Protocol Buffer的解析规范去实现相应的方法，主需关注自己要序列化的结构。\n  ```\n  package bs.maven.test.protobuf;\n  option java_package = \"bs.maven.test.protobuf\";\n  option java_outer_classname = \"AddressBookProtos\";\n  \n  message Person {\n    required string name = 1;\n    required int32 id = 2;\n    optional string email = 3;\n  \n    enum PhoneType {\n      MOBILE = 0;\n      HOME = 1;\n      WORK = 2;\n    }\n  \n    message PhoneNumber {\n      required string number = 1;\n      optional PhoneType type = 2 [default = HOME];\n    }\n  \n    repeated PhoneNumber phone = 4;\n  }\n  \n  message AddressBook {\n    repeated Person person = 1;\n  }\n  ```\n### 编译proto文件\n```\n  protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto\n```\n[Mac上protoc编译器的安装参看](http://my.oschina.net/KingPan/blog/283881?fromerr=8vajR5S9)\n\n### 使用proto文件\n\n  将生成的AddressBookProtos代码直接拷贝到相应的目录就可以直接开发。以文件的方式表示序列化过程，网络传输同理。\n  * 工程Maven 依赖：\n  ```\n  <dependency>\n\t\t\t<groupId>com.google.protobuf</groupId>\n\t\t\t<artifactId>protobuf-java</artifactId>\n\t\t\t<version>2.5.0</version>\n\t\t</dependency>\n  ```\n  * 实例代码\n  ```\n  public class AddressTest {\n\n\tprivate static final String fileName = \"/Users/bianshuai/Documents/tmp/protobuf/address\";\n\n\tpublic static void main(String[] args) {\n\t\twrite();\n\t\tread();\n\t}\n\n\tpublic static void write() {\n\n\t\tAddressBookProtos.Person john = Person.newBuilder().setId(1234).setName(\"John Doe\").setEmail(\"jdoe@example.com\")\n\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(\"555-4321\").setType(Person.PhoneType.HOME)).build();\n\n\t\tAddressBookProtos.Person gavin = Person.newBuilder().setId(12345).setName(\"gavin Doe\")\n\t\t\t\t.setEmail(\"gavin@example.com\")\n\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(\"555-4323\").setType(Person.PhoneType.HOME)).build();\n\n\t\tAddressBookProtos.AddressBook address = AddressBookProtos.AddressBook.newBuilder().addPerson(john)\n\t\t\t\t.addPerson(gavin).build();\n\t\tFileOutputStream output = null;\n\t\ttry {\n\t\t\toutput = new FileOutputStream(\"fileName\");\n\t\t\taddress.writeTo(output);\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tif (null != output) {\n\t\t\t\ttry {\n\t\t\t\t\toutput.close();\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void read() {\n\t\tAddressBook addressBook;\n\t\ttry {\n\t\t\taddressBook = AddressBook.parseFrom(new FileInputStream(fileName));\n\t\t\tPrint(addressBook);\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n\tstatic void Print(AddressBook addressBook) {\n\t\tfor (Person person : addressBook.getPersonList()) {\n\t\t\tSystem.out.println(\"Person ID: \" + person.getId());\n\t\t\tSystem.out.println(\"  Name: \" + person.getName());\n\t\t\tif (person.hasEmail()) {\n\t\t\t\tSystem.out.println(\"  E-mail address: \" + person.getEmail());\n\t\t\t}\n\n\t\t\tfor (Person.PhoneNumber phoneNumber : person.getPhoneList()) {\n\t\t\t\tswitch (phoneNumber.getType()) {\n\t\t\t\tcase MOBILE:\n\t\t\t\t\tSystem.out.print(\"  Mobile phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\tcase HOME:\n\t\t\t\t\tSystem.out.print(\"  Home phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\tcase WORK:\n\t\t\t\t\tSystem.out.print(\"  Work phone #: \");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tSystem.out.println(phoneNumber.getNumber());\n\t\t\t}\n\t\t}\n\t}\n}\n  ```\n  \n### proto文件简单语法分析\n参考Google开发文档(https://developers.google.com/protocol-buffers/docs/proto)\n\n> .proto文件起始于一个包声明，这能够帮助在不同的工程中避免命名冲突。在使用Java的情况下，package name被用来作为Java的package，除非你详细指定了一个java_package，正如我们在这里是这样做的。即使你却是提供了一个java_package，你也应该仍旧定义一个正常的package以便在Protocol Buffers命名空间和非Java语言中避免命名冲突。\n\n> 在包声明以后，你会看到两个Java特有的配置项：java_package和java_outer_classname。java_package指定你生成的类要存在于什么包下。如果你没有具体的指定，它会简单的与package给出的package name相匹配，但是这些名字通常不适合做为Java包的名字（因为它们通常不以域名开头）。java_outer_classname配置项定义了那些在这个文件中包含所有类的名称。如果你没有具体指定java_outer_classname，它将会转换文件名为驼峰式来产生。例如，“my_proto.proto”将默认使用“MyProto”做为outer class name(类的文件名)。\n\n> 接下来是你的message定义。一个message只是一系列具有类型的域的集合。许多标准的简单类型可以做为可用的域类型，包括bool, int32, float, double, 和string。你同样可以向你的message中添加更多的结构，通过把其他的message类型当做域类型使用－－在上面的例子中，Person message包含PhoneNumber message，而AddressBook message包含Person message。你甚至可以通过内部嵌套其它message的方式定义message，你可以看到，PhoneNumber类型被定义在Person里面。你同样可以定义enum类型，如果你希望其中的一个你的域拥有预定义列表中的一个值－－在这里，你希望指定一个phone number的值是MOBILE, HOME, 或者WORK中的一个。\n\n> 这里在每个元素上面的“=1”，“=2”标记，辨识唯一的“tag”，这些“tag”是域在二进制编码的时候使用的。Tag编号从1到15，需要比更大的数字少一个字节，因此，出于优化考虑你可以决定使用常用的或者重复的元素。而从16到更高的编号留给不常用的可选元素。在重复域中的每一个元素都需要重新编码tag number，所以，使用重复域对优化来说是特别好的选择。\n\n> 每一个域都必须被下面之一的modifer注解：\n* required：域的值必须被提供，否则message会被认为是“未初始化的”。试图创建一个未初始化的message将会抛出一个RuntimeException。转化一个未初始化的message将会抛出一个IOException。除了这些，required域的行为和optional域表现相同。\n* optional：该域可能被设置，也可能未被设置。如果一个optional域未被设置，默认的值将会被使用。对于简单类型来说，你可以指定你自己的默认值，就像我们在例子中对phone number类型所做的那样。否则，一个系统默认的值将被使用：数值类型是0，字符串类型是\"\"，布尔类型是false。对于嵌入式的message来说，默认值总是这个message的没有任何域被设置过的“默认实例”或“原型”。调用访问器去获取一个optional或者required域的值，这些域如果没有被具体设置，那么总是返回域的默认值。\n* repeated：域将会被重复任意次数（包括0次）。重复的值的顺序将会被保存在protocol buffer中。可以把重复的域想成变长的数组。 \n  \n  \n### 总结\n最近查看一个开源p2p项目的代码，其中指令协议本身是已经固定好的，十分适合使用Protocol Buffer作为协议命令传输。\n","slug":"protocol-buffer-demo","published":1,"updated":"2017-01-05T03:06:23.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cixq3mp9t0005ez0tn0ffjnld","content":"<p>Protocol Buffer &#x662F;Google&#x4E00;&#x6B3E;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65B9;&#x6848;&#x3002;&#x5E8F;&#x5217;&#x5316;&#x662F;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x5728;&#x73B0;&#x9636;&#x6BB5;&#x5206;&#x5E03;&#x5F0F;&#x4F7F;&#x7528;&#x6108;&#x52A0;&#x5E7F;&#x6CDB;&#x7684;&#x80CC;&#x666F;&#x4E0B;&#xFF0C;&#x9AD8;&#x6548;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x6848;&#x662F;&#x5FC5;&#x987B;&#x7684;&#x3002;&#x6BD4;&#x5982;Rpc&#xFF0C;Netty&#x90FD;&#x6709;&#x57FA;&#x4E8E;protocol buffer&#x7684;&#x5B9E;&#x73B0;&#x3002;<br>&#x4ECA;&#x5929;&#x5199;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;&#x5F00;&#x53D1;&#x7684;&#x5168;&#x8FC7;&#x7A0B;&#x3002;</p>\n<h3 id=\"&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\"><a href=\"#&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\"></a>&#x7F16;&#x5199;proto&#x6587;&#x4EF6;</h3><p>  proto&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6A21;&#x677F;&#x7ED3;&#x6784;&#xFF0C;&#x540E;&#x7EED;proto&#x7F16;&#x8BD1;&#x5668;&#x80FD;&#x591F;&#x6839;&#x636E;&#x7528;&#x6237;&#x7F16;&#x5199;&#x7684;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x751F;&#x6210;&#x76F8;&#x5E94;&#x7684;java&#x7C7B;&#x3002;<br>  proto&#x6587;&#x4EF6;&#x662F;&#x9759;&#x6001;&#x7684;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x7ED3;&#x6784;&#x5C31;&#x53EF;&#x4EE5;&#x76F8;&#x5F53;&#x4E8E;&#x8D2B;&#x8840;&#x6A21;&#x5F0F;&#x7684;&#x4EE3;&#x7801;&#xFF1B;&#x540E;&#x7EED;&#x751F;&#x6210;&#x7684;java&#x6587;&#x4EF6;&#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210;&#xFF0C;get/set/build/parse&#x7B49;Protocol Buffer&#x89E3;&#x6790;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x5145;&#x8840;&#x6A21;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7528;&#x6237;&#x5C31;&#x4E0D;&#x5FC5;&#x7406;&#x89E3;Protocol Buffer&#x7684;&#x89E3;&#x6790;&#x89C4;&#x8303;&#x53BB;&#x5B9E;&#x73B0;&#x76F8;&#x5E94;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E3B;&#x9700;&#x5173;&#x6CE8;&#x81EA;&#x5DF1;&#x8981;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7ED3;&#x6784;&#x3002;<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">package bs.maven.test.protobuf;</div><div class=\"line\">option java_package = &quot;bs.maven.test.protobuf&quot;;</div><div class=\"line\">option java_outer_classname = &quot;AddressBookProtos&quot;;</div><div class=\"line\"></div><div class=\"line\">message Person {</div><div class=\"line\">  required string name = 1;</div><div class=\"line\">  required int32 id = 2;</div><div class=\"line\">  optional string email = 3;</div><div class=\"line\"></div><div class=\"line\">  enum PhoneType {</div><div class=\"line\">    MOBILE = 0;</div><div class=\"line\">    HOME = 1;</div><div class=\"line\">    WORK = 2;</div><div class=\"line\">  }</div><div class=\"line\"></div><div class=\"line\">  message PhoneNumber {</div><div class=\"line\">    required string number = 1;</div><div class=\"line\">    optional PhoneType type = 2 [default = HOME];</div><div class=\"line\">  }</div><div class=\"line\"></div><div class=\"line\">  repeated PhoneNumber phone = 4;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">message AddressBook {</div><div class=\"line\">  repeated Person person = 1;</div><div class=\"line\">}</div></pre></td></tr></table></figure></p>\n<h3 id=\"&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\"><a href=\"#&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\"></a>&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto</div></pre></td></tr></table></figure>\n<p><a href=\"http://my.oschina.net/KingPan/blog/283881?fromerr=8vajR5S9\" target=\"_blank\" rel=\"external\">Mac&#x4E0A;protoc&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x5B89;&#x88C5;&#x53C2;&#x770B;</a></p>\n<h3 id=\"&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\"><a href=\"#&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\"></a>&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;</h3><p>  &#x5C06;&#x751F;&#x6210;&#x7684;AddressBookProtos&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x62F7;&#x8D1D;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x76EE;&#x5F55;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F00;&#x53D1;&#x3002;&#x4EE5;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x8868;&#x793A;&#x5E8F;&#x5217;&#x5316;&#x8FC7;&#x7A0B;&#xFF0C;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x540C;&#x7406;&#x3002;</p>\n<ul>\n<li><p>&#x5DE5;&#x7A0B;Maven &#x4F9D;&#x8D56;&#xFF1A;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency&gt;</div><div class=\"line\">\t&lt;groupId&gt;com.google.protobuf&lt;/groupId&gt;</div><div class=\"line\">\t&lt;artifactId&gt;protobuf-java&lt;/artifactId&gt;</div><div class=\"line\">\t&lt;version&gt;2.5.0&lt;/version&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure>\n</li>\n<li><p>&#x5B9E;&#x4F8B;&#x4EE3;&#x7801;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div></pre></td><td class=\"code\"><pre><div class=\"line\">  public class AddressTest {</div><div class=\"line\"></div><div class=\"line\">\tprivate static final String fileName = &quot;/Users/bianshuai/Documents/tmp/protobuf/address&quot;;</div><div class=\"line\"></div><div class=\"line\">\tpublic static void main(String[] args) {</div><div class=\"line\">\t\twrite();</div><div class=\"line\">\t\tread();</div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tpublic static void write() {</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.Person john = Person.newBuilder().setId(1234).setName(&quot;John Doe&quot;).setEmail(&quot;jdoe@example.com&quot;)</div><div class=\"line\">\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(&quot;555-4321&quot;).setType(Person.PhoneType.HOME)).build();</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.Person gavin = Person.newBuilder().setId(12345).setName(&quot;gavin Doe&quot;)</div><div class=\"line\">\t\t\t\t.setEmail(&quot;gavin@example.com&quot;)</div><div class=\"line\">\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(&quot;555-4323&quot;).setType(Person.PhoneType.HOME)).build();</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.AddressBook address = AddressBookProtos.AddressBook.newBuilder().addPerson(john)</div><div class=\"line\">\t\t\t\t.addPerson(gavin).build();</div><div class=\"line\">\t\tFileOutputStream output = null;</div><div class=\"line\">\t\ttry {</div><div class=\"line\">\t\t\toutput = new FileOutputStream(&quot;fileName&quot;);</div><div class=\"line\">\t\t\taddress.writeTo(output);</div><div class=\"line\">\t\t} catch (IOException e) {</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t} finally {</div><div class=\"line\">\t\t\tif (null != output) {</div><div class=\"line\">\t\t\t\ttry {</div><div class=\"line\">\t\t\t\t\toutput.close();</div><div class=\"line\">\t\t\t\t} catch (IOException e) {</div><div class=\"line\">\t\t\t\t}</div><div class=\"line\">\t\t\t}</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tpublic static void read() {</div><div class=\"line\">\t\tAddressBook addressBook;</div><div class=\"line\">\t\ttry {</div><div class=\"line\">\t\t\taddressBook = AddressBook.parseFrom(new FileInputStream(fileName));</div><div class=\"line\">\t\t\tPrint(addressBook);</div><div class=\"line\">\t\t} catch (Exception e) {</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t}</div><div class=\"line\"></div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tstatic void Print(AddressBook addressBook) {</div><div class=\"line\">\t\tfor (Person person : addressBook.getPersonList()) {</div><div class=\"line\">\t\t\tSystem.out.println(&quot;Person ID: &quot; + person.getId());</div><div class=\"line\">\t\t\tSystem.out.println(&quot;  Name: &quot; + person.getName());</div><div class=\"line\">\t\t\tif (person.hasEmail()) {</div><div class=\"line\">\t\t\t\tSystem.out.println(&quot;  E-mail address: &quot; + person.getEmail());</div><div class=\"line\">\t\t\t}</div><div class=\"line\"></div><div class=\"line\">\t\t\tfor (Person.PhoneNumber phoneNumber : person.getPhoneList()) {</div><div class=\"line\">\t\t\t\tswitch (phoneNumber.getType()) {</div><div class=\"line\">\t\t\t\tcase MOBILE:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Mobile phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\tcase HOME:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Home phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\tcase WORK:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Work phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\t}</div><div class=\"line\">\t\t\t\tSystem.out.println(phoneNumber.getNumber());</div><div class=\"line\">\t\t\t}</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\"><a href=\"#proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\" class=\"headerlink\" title=\"proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\"></a>proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;</h3><p>&#x53C2;&#x8003;Google&#x5F00;&#x53D1;&#x6587;&#x6863;(<a href=\"https://developers.google.com/protocol-buffers/docs/proto\" target=\"_blank\" rel=\"external\">https://developers.google.com/protocol-buffers/docs/proto</a>)</p>\n<blockquote>\n<p>.proto&#x6587;&#x4EF6;&#x8D77;&#x59CB;&#x4E8E;&#x4E00;&#x4E2A;&#x5305;&#x58F0;&#x660E;&#xFF0C;&#x8FD9;&#x80FD;&#x591F;&#x5E2E;&#x52A9;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x5DE5;&#x7A0B;&#x4E2D;&#x907F;&#x514D;&#x547D;&#x540D;&#x51B2;&#x7A81;&#x3002;&#x5728;&#x4F7F;&#x7528;Java&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;package name&#x88AB;&#x7528;&#x6765;&#x4F5C;&#x4E3A;Java&#x7684;package&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x8BE6;&#x7EC6;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;java_package&#xFF0C;&#x6B63;&#x5982;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x662F;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x3002;&#x5373;&#x4F7F;&#x4F60;&#x5374;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;java_package&#xFF0C;&#x4F60;&#x4E5F;&#x5E94;&#x8BE5;&#x4ECD;&#x65E7;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6B63;&#x5E38;&#x7684;package&#x4EE5;&#x4FBF;&#x5728;Protocol Buffers&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x548C;&#x975E;Java&#x8BED;&#x8A00;&#x4E2D;&#x907F;&#x514D;&#x547D;&#x540D;&#x51B2;&#x7A81;&#x3002;</p>\n<p>&#x5728;&#x5305;&#x58F0;&#x660E;&#x4EE5;&#x540E;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x4E24;&#x4E2A;Java&#x7279;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x9879;&#xFF1A;java_package&#x548C;java_outer_classname&#x3002;java_package&#x6307;&#x5B9A;&#x4F60;&#x751F;&#x6210;&#x7684;&#x7C7B;&#x8981;&#x5B58;&#x5728;&#x4E8E;&#x4EC0;&#x4E48;&#x5305;&#x4E0B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x5177;&#x4F53;&#x7684;&#x6307;&#x5B9A;&#xFF0C;&#x5B83;&#x4F1A;&#x7B80;&#x5355;&#x7684;&#x4E0E;package&#x7ED9;&#x51FA;&#x7684;package name&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x540D;&#x5B57;&#x901A;&#x5E38;&#x4E0D;&#x9002;&#x5408;&#x505A;&#x4E3A;Java&#x5305;&#x7684;&#x540D;&#x5B57;&#xFF08;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x901A;&#x5E38;&#x4E0D;&#x4EE5;&#x57DF;&#x540D;&#x5F00;&#x5934;&#xFF09;&#x3002;java_outer_classname&#x914D;&#x7F6E;&#x9879;&#x5B9A;&#x4E49;&#x4E86;&#x90A3;&#x4E9B;&#x5728;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x5305;&#x542B;&#x6240;&#x6709;&#x7C7B;&#x7684;&#x540D;&#x79F0;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x5177;&#x4F53;&#x6307;&#x5B9A;java_outer_classname&#xFF0C;&#x5B83;&#x5C06;&#x4F1A;&#x8F6C;&#x6362;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x9A7C;&#x5CF0;&#x5F0F;&#x6765;&#x4EA7;&#x751F;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x201C;my_proto.proto&#x201D;&#x5C06;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x201C;MyProto&#x201D;&#x505A;&#x4E3A;outer class name(&#x7C7B;&#x7684;&#x6587;&#x4EF6;&#x540D;)&#x3002;</p>\n<p>&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x4F60;&#x7684;message&#x5B9A;&#x4E49;&#x3002;&#x4E00;&#x4E2A;message&#x53EA;&#x662F;&#x4E00;&#x7CFB;&#x5217;&#x5177;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x57DF;&#x7684;&#x96C6;&#x5408;&#x3002;&#x8BB8;&#x591A;&#x6807;&#x51C6;&#x7684;&#x7B80;&#x5355;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x505A;&#x4E3A;&#x53EF;&#x7528;&#x7684;&#x57DF;&#x7C7B;&#x578B;&#xFF0C;&#x5305;&#x62EC;bool, int32, float, double, &#x548C;string&#x3002;&#x4F60;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x5411;&#x4F60;&#x7684;message&#x4E2D;&#x6DFB;&#x52A0;&#x66F4;&#x591A;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x901A;&#x8FC7;&#x628A;&#x5176;&#x4ED6;&#x7684;message&#x7C7B;&#x578B;&#x5F53;&#x505A;&#x57DF;&#x7C7B;&#x578B;&#x4F7F;&#x7528;&#xFF0D;&#xFF0D;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;Person message&#x5305;&#x542B;PhoneNumber message&#xFF0C;&#x800C;AddressBook message&#x5305;&#x542B;Person message&#x3002;&#x4F60;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5185;&#x90E8;&#x5D4C;&#x5957;&#x5176;&#x5B83;message&#x7684;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;message&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;PhoneNumber&#x7C7B;&#x578B;&#x88AB;&#x5B9A;&#x4E49;&#x5728;Person&#x91CC;&#x9762;&#x3002;&#x4F60;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;enum&#x7C7B;&#x578B;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x4F60;&#x7684;&#x57DF;&#x62E5;&#x6709;&#x9884;&#x5B9A;&#x4E49;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x503C;&#xFF0D;&#xFF0D;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x5E0C;&#x671B;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;phone number&#x7684;&#x503C;&#x662F;MOBILE, HOME, &#x6216;&#x8005;WORK&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;</p>\n<p>&#x8FD9;&#x91CC;&#x5728;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x4E0A;&#x9762;&#x7684;&#x201C;=1&#x201D;&#xFF0C;&#x201C;=2&#x201D;&#x6807;&#x8BB0;&#xFF0C;&#x8FA8;&#x8BC6;&#x552F;&#x4E00;&#x7684;&#x201C;tag&#x201D;&#xFF0C;&#x8FD9;&#x4E9B;&#x201C;tag&#x201D;&#x662F;&#x57DF;&#x5728;&#x4E8C;&#x8FDB;&#x5236;&#x7F16;&#x7801;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x7684;&#x3002;Tag&#x7F16;&#x53F7;&#x4ECE;1&#x5230;15&#xFF0C;&#x9700;&#x8981;&#x6BD4;&#x66F4;&#x5927;&#x7684;&#x6570;&#x5B57;&#x5C11;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x51FA;&#x4E8E;&#x4F18;&#x5316;&#x8003;&#x8651;&#x4F60;&#x53EF;&#x4EE5;&#x51B3;&#x5B9A;&#x4F7F;&#x7528;&#x5E38;&#x7528;&#x7684;&#x6216;&#x8005;&#x91CD;&#x590D;&#x7684;&#x5143;&#x7D20;&#x3002;&#x800C;&#x4ECE;16&#x5230;&#x66F4;&#x9AD8;&#x7684;&#x7F16;&#x53F7;&#x7559;&#x7ED9;&#x4E0D;&#x5E38;&#x7528;&#x7684;&#x53EF;&#x9009;&#x5143;&#x7D20;&#x3002;&#x5728;&#x91CD;&#x590D;&#x57DF;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x7F16;&#x7801;tag number&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x4F7F;&#x7528;&#x91CD;&#x590D;&#x57DF;&#x5BF9;&#x4F18;&#x5316;&#x6765;&#x8BF4;&#x662F;&#x7279;&#x522B;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;</p>\n<p>&#x6BCF;&#x4E00;&#x4E2A;&#x57DF;&#x90FD;&#x5FC5;&#x987B;&#x88AB;&#x4E0B;&#x9762;&#x4E4B;&#x4E00;&#x7684;modifer&#x6CE8;&#x89E3;&#xFF1A;</p>\n<ul>\n<li>required&#xFF1A;&#x57DF;&#x7684;&#x503C;&#x5FC5;&#x987B;&#x88AB;&#x63D0;&#x4F9B;&#xFF0C;&#x5426;&#x5219;message&#x4F1A;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x201C;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;&#x201D;&#x3002;&#x8BD5;&#x56FE;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;message&#x5C06;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;RuntimeException&#x3002;&#x8F6C;&#x5316;&#x4E00;&#x4E2A;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;message&#x5C06;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;IOException&#x3002;&#x9664;&#x4E86;&#x8FD9;&#x4E9B;&#xFF0C;required&#x57DF;&#x7684;&#x884C;&#x4E3A;&#x548C;optional&#x57DF;&#x8868;&#x73B0;&#x76F8;&#x540C;&#x3002;</li>\n<li>optional&#xFF1A;&#x8BE5;&#x57DF;&#x53EF;&#x80FD;&#x88AB;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x672A;&#x88AB;&#x8BBE;&#x7F6E;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;optional&#x57DF;&#x672A;&#x88AB;&#x8BBE;&#x7F6E;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x503C;&#x5C06;&#x4F1A;&#x88AB;&#x4F7F;&#x7528;&#x3002;&#x5BF9;&#x4E8E;&#x7B80;&#x5355;&#x7C7B;&#x578B;&#x6765;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x5C31;&#x50CF;&#x6211;&#x4EEC;&#x5728;&#x4F8B;&#x5B50;&#x4E2D;&#x5BF9;phone number&#x7C7B;&#x578B;&#x6240;&#x505A;&#x7684;&#x90A3;&#x6837;&#x3002;&#x5426;&#x5219;&#xFF0C;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x7684;&#x503C;&#x5C06;&#x88AB;&#x4F7F;&#x7528;&#xFF1A;&#x6570;&#x503C;&#x7C7B;&#x578B;&#x662F;0&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x662F;&#x201D;&#x201D;&#xFF0C;&#x5E03;&#x5C14;&#x7C7B;&#x578B;&#x662F;false&#x3002;&#x5BF9;&#x4E8E;&#x5D4C;&#x5165;&#x5F0F;&#x7684;message&#x6765;&#x8BF4;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x603B;&#x662F;&#x8FD9;&#x4E2A;message&#x7684;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x57DF;&#x88AB;&#x8BBE;&#x7F6E;&#x8FC7;&#x7684;&#x201C;&#x9ED8;&#x8BA4;&#x5B9E;&#x4F8B;&#x201D;&#x6216;&#x201C;&#x539F;&#x578B;&#x201D;&#x3002;&#x8C03;&#x7528;&#x8BBF;&#x95EE;&#x5668;&#x53BB;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;optional&#x6216;&#x8005;required&#x57DF;&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x4E9B;&#x57DF;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x88AB;&#x5177;&#x4F53;&#x8BBE;&#x7F6E;&#xFF0C;&#x90A3;&#x4E48;&#x603B;&#x662F;&#x8FD4;&#x56DE;&#x57DF;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</li>\n<li>repeated&#xFF1A;&#x57DF;&#x5C06;&#x4F1A;&#x88AB;&#x91CD;&#x590D;&#x4EFB;&#x610F;&#x6B21;&#x6570;&#xFF08;&#x5305;&#x62EC;0&#x6B21;&#xFF09;&#x3002;&#x91CD;&#x590D;&#x7684;&#x503C;&#x7684;&#x987A;&#x5E8F;&#x5C06;&#x4F1A;&#x88AB;&#x4FDD;&#x5B58;&#x5728;protocol buffer&#x4E2D;&#x3002;&#x53EF;&#x4EE5;&#x628A;&#x91CD;&#x590D;&#x7684;&#x57DF;&#x60F3;&#x6210;&#x53D8;&#x957F;&#x7684;&#x6570;&#x7EC4;&#x3002; </li>\n</ul>\n</blockquote>\n<h3 id=\"&#x603B;&#x7ED3;\"><a href=\"#&#x603B;&#x7ED3;\" class=\"headerlink\" title=\"&#x603B;&#x7ED3;\"></a>&#x603B;&#x7ED3;</h3><p>&#x6700;&#x8FD1;&#x67E5;&#x770B;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;p2p&#x9879;&#x76EE;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x4E2D;&#x6307;&#x4EE4;&#x534F;&#x8BAE;&#x672C;&#x8EAB;&#x662F;&#x5DF2;&#x7ECF;&#x56FA;&#x5B9A;&#x597D;&#x7684;&#xFF0C;&#x5341;&#x5206;&#x9002;&#x5408;&#x4F7F;&#x7528;Protocol Buffer&#x4F5C;&#x4E3A;&#x534F;&#x8BAE;&#x547D;&#x4EE4;&#x4F20;&#x8F93;&#x3002;</p>\n","excerpt":"","more":"<p>Protocol Buffer &#x662F;Google&#x4E00;&#x6B3E;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65B9;&#x6848;&#x3002;&#x5E8F;&#x5217;&#x5316;&#x662F;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x5728;&#x73B0;&#x9636;&#x6BB5;&#x5206;&#x5E03;&#x5F0F;&#x4F7F;&#x7528;&#x6108;&#x52A0;&#x5E7F;&#x6CDB;&#x7684;&#x80CC;&#x666F;&#x4E0B;&#xFF0C;&#x9AD8;&#x6548;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x6848;&#x662F;&#x5FC5;&#x987B;&#x7684;&#x3002;&#x6BD4;&#x5982;Rpc&#xFF0C;Netty&#x90FD;&#x6709;&#x57FA;&#x4E8E;protocol buffer&#x7684;&#x5B9E;&#x73B0;&#x3002;<br>&#x4ECA;&#x5929;&#x5199;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;&#x5F00;&#x53D1;&#x7684;&#x5168;&#x8FC7;&#x7A0B;&#x3002;</p>\n<h3 id=\"&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\"><a href=\"#&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x7F16;&#x5199;proto&#x6587;&#x4EF6;\"></a>&#x7F16;&#x5199;proto&#x6587;&#x4EF6;</h3><p>  proto&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6A21;&#x677F;&#x7ED3;&#x6784;&#xFF0C;&#x540E;&#x7EED;proto&#x7F16;&#x8BD1;&#x5668;&#x80FD;&#x591F;&#x6839;&#x636E;&#x7528;&#x6237;&#x7F16;&#x5199;&#x7684;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x751F;&#x6210;&#x76F8;&#x5E94;&#x7684;java&#x7C7B;&#x3002;<br>  proto&#x6587;&#x4EF6;&#x662F;&#x9759;&#x6001;&#x7684;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x7ED3;&#x6784;&#x5C31;&#x53EF;&#x4EE5;&#x76F8;&#x5F53;&#x4E8E;&#x8D2B;&#x8840;&#x6A21;&#x5F0F;&#x7684;&#x4EE3;&#x7801;&#xFF1B;&#x540E;&#x7EED;&#x751F;&#x6210;&#x7684;java&#x6587;&#x4EF6;&#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210;&#xFF0C;get/set/build/parse&#x7B49;Protocol Buffer&#x89E3;&#x6790;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x5145;&#x8840;&#x6A21;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7528;&#x6237;&#x5C31;&#x4E0D;&#x5FC5;&#x7406;&#x89E3;Protocol Buffer&#x7684;&#x89E3;&#x6790;&#x89C4;&#x8303;&#x53BB;&#x5B9E;&#x73B0;&#x76F8;&#x5E94;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E3B;&#x9700;&#x5173;&#x6CE8;&#x81EA;&#x5DF1;&#x8981;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7ED3;&#x6784;&#x3002;<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">package bs.maven.test.protobuf;</div><div class=\"line\">option java_package = &quot;bs.maven.test.protobuf&quot;;</div><div class=\"line\">option java_outer_classname = &quot;AddressBookProtos&quot;;</div><div class=\"line\"></div><div class=\"line\">message Person {</div><div class=\"line\">  required string name = 1;</div><div class=\"line\">  required int32 id = 2;</div><div class=\"line\">  optional string email = 3;</div><div class=\"line\"></div><div class=\"line\">  enum PhoneType {</div><div class=\"line\">    MOBILE = 0;</div><div class=\"line\">    HOME = 1;</div><div class=\"line\">    WORK = 2;</div><div class=\"line\">  }</div><div class=\"line\"></div><div class=\"line\">  message PhoneNumber {</div><div class=\"line\">    required string number = 1;</div><div class=\"line\">    optional PhoneType type = 2 [default = HOME];</div><div class=\"line\">  }</div><div class=\"line\"></div><div class=\"line\">  repeated PhoneNumber phone = 4;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">message AddressBook {</div><div class=\"line\">  repeated Person person = 1;</div><div class=\"line\">}</div></pre></td></tr></table></figure></p>\n<h3 id=\"&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\"><a href=\"#&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;\"></a>&#x7F16;&#x8BD1;proto&#x6587;&#x4EF6;</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto</div></pre></td></tr></table></figure>\n<p><a href=\"http://my.oschina.net/KingPan/blog/283881?fromerr=8vajR5S9\">Mac&#x4E0A;protoc&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x5B89;&#x88C5;&#x53C2;&#x770B;</a></p>\n<h3 id=\"&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\"><a href=\"#&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\" class=\"headerlink\" title=\"&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;\"></a>&#x4F7F;&#x7528;proto&#x6587;&#x4EF6;</h3><p>  &#x5C06;&#x751F;&#x6210;&#x7684;AddressBookProtos&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x62F7;&#x8D1D;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x76EE;&#x5F55;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F00;&#x53D1;&#x3002;&#x4EE5;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x8868;&#x793A;&#x5E8F;&#x5217;&#x5316;&#x8FC7;&#x7A0B;&#xFF0C;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x540C;&#x7406;&#x3002;</p>\n<ul>\n<li><p>&#x5DE5;&#x7A0B;Maven &#x4F9D;&#x8D56;&#xFF1A;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency&gt;</div><div class=\"line\">\t&lt;groupId&gt;com.google.protobuf&lt;/groupId&gt;</div><div class=\"line\">\t&lt;artifactId&gt;protobuf-java&lt;/artifactId&gt;</div><div class=\"line\">\t&lt;version&gt;2.5.0&lt;/version&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure>\n</li>\n<li><p>&#x5B9E;&#x4F8B;&#x4EE3;&#x7801;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div></pre></td><td class=\"code\"><pre><div class=\"line\">  public class AddressTest {</div><div class=\"line\"></div><div class=\"line\">\tprivate static final String fileName = &quot;/Users/bianshuai/Documents/tmp/protobuf/address&quot;;</div><div class=\"line\"></div><div class=\"line\">\tpublic static void main(String[] args) {</div><div class=\"line\">\t\twrite();</div><div class=\"line\">\t\tread();</div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tpublic static void write() {</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.Person john = Person.newBuilder().setId(1234).setName(&quot;John Doe&quot;).setEmail(&quot;jdoe@example.com&quot;)</div><div class=\"line\">\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(&quot;555-4321&quot;).setType(Person.PhoneType.HOME)).build();</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.Person gavin = Person.newBuilder().setId(12345).setName(&quot;gavin Doe&quot;)</div><div class=\"line\">\t\t\t\t.setEmail(&quot;gavin@example.com&quot;)</div><div class=\"line\">\t\t\t\t.addPhone(Person.PhoneNumber.newBuilder().setNumber(&quot;555-4323&quot;).setType(Person.PhoneType.HOME)).build();</div><div class=\"line\"></div><div class=\"line\">\t\tAddressBookProtos.AddressBook address = AddressBookProtos.AddressBook.newBuilder().addPerson(john)</div><div class=\"line\">\t\t\t\t.addPerson(gavin).build();</div><div class=\"line\">\t\tFileOutputStream output = null;</div><div class=\"line\">\t\ttry {</div><div class=\"line\">\t\t\toutput = new FileOutputStream(&quot;fileName&quot;);</div><div class=\"line\">\t\t\taddress.writeTo(output);</div><div class=\"line\">\t\t} catch (IOException e) {</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t} finally {</div><div class=\"line\">\t\t\tif (null != output) {</div><div class=\"line\">\t\t\t\ttry {</div><div class=\"line\">\t\t\t\t\toutput.close();</div><div class=\"line\">\t\t\t\t} catch (IOException e) {</div><div class=\"line\">\t\t\t\t}</div><div class=\"line\">\t\t\t}</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tpublic static void read() {</div><div class=\"line\">\t\tAddressBook addressBook;</div><div class=\"line\">\t\ttry {</div><div class=\"line\">\t\t\taddressBook = AddressBook.parseFrom(new FileInputStream(fileName));</div><div class=\"line\">\t\t\tPrint(addressBook);</div><div class=\"line\">\t\t} catch (Exception e) {</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t}</div><div class=\"line\"></div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">\tstatic void Print(AddressBook addressBook) {</div><div class=\"line\">\t\tfor (Person person : addressBook.getPersonList()) {</div><div class=\"line\">\t\t\tSystem.out.println(&quot;Person ID: &quot; + person.getId());</div><div class=\"line\">\t\t\tSystem.out.println(&quot;  Name: &quot; + person.getName());</div><div class=\"line\">\t\t\tif (person.hasEmail()) {</div><div class=\"line\">\t\t\t\tSystem.out.println(&quot;  E-mail address: &quot; + person.getEmail());</div><div class=\"line\">\t\t\t}</div><div class=\"line\"></div><div class=\"line\">\t\t\tfor (Person.PhoneNumber phoneNumber : person.getPhoneList()) {</div><div class=\"line\">\t\t\t\tswitch (phoneNumber.getType()) {</div><div class=\"line\">\t\t\t\tcase MOBILE:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Mobile phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\tcase HOME:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Home phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\tcase WORK:</div><div class=\"line\">\t\t\t\t\tSystem.out.print(&quot;  Work phone #: &quot;);</div><div class=\"line\">\t\t\t\t\tbreak;</div><div class=\"line\">\t\t\t\t}</div><div class=\"line\">\t\t\t\tSystem.out.println(phoneNumber.getNumber());</div><div class=\"line\">\t\t\t}</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\"><a href=\"#proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\" class=\"headerlink\" title=\"proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;\"></a>proto&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x8BED;&#x6CD5;&#x5206;&#x6790;</h3><p>&#x53C2;&#x8003;Google&#x5F00;&#x53D1;&#x6587;&#x6863;(<a href=\"https://developers.google.com/protocol-buffers/docs/proto\">https://developers.google.com/protocol-buffers/docs/proto</a>)</p>\n<blockquote>\n<p>.proto&#x6587;&#x4EF6;&#x8D77;&#x59CB;&#x4E8E;&#x4E00;&#x4E2A;&#x5305;&#x58F0;&#x660E;&#xFF0C;&#x8FD9;&#x80FD;&#x591F;&#x5E2E;&#x52A9;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x5DE5;&#x7A0B;&#x4E2D;&#x907F;&#x514D;&#x547D;&#x540D;&#x51B2;&#x7A81;&#x3002;&#x5728;&#x4F7F;&#x7528;Java&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;package name&#x88AB;&#x7528;&#x6765;&#x4F5C;&#x4E3A;Java&#x7684;package&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x8BE6;&#x7EC6;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;java_package&#xFF0C;&#x6B63;&#x5982;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x662F;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x3002;&#x5373;&#x4F7F;&#x4F60;&#x5374;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;java_package&#xFF0C;&#x4F60;&#x4E5F;&#x5E94;&#x8BE5;&#x4ECD;&#x65E7;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6B63;&#x5E38;&#x7684;package&#x4EE5;&#x4FBF;&#x5728;Protocol Buffers&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x548C;&#x975E;Java&#x8BED;&#x8A00;&#x4E2D;&#x907F;&#x514D;&#x547D;&#x540D;&#x51B2;&#x7A81;&#x3002;</p>\n<p>&#x5728;&#x5305;&#x58F0;&#x660E;&#x4EE5;&#x540E;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x4E24;&#x4E2A;Java&#x7279;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x9879;&#xFF1A;java_package&#x548C;java_outer_classname&#x3002;java_package&#x6307;&#x5B9A;&#x4F60;&#x751F;&#x6210;&#x7684;&#x7C7B;&#x8981;&#x5B58;&#x5728;&#x4E8E;&#x4EC0;&#x4E48;&#x5305;&#x4E0B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x5177;&#x4F53;&#x7684;&#x6307;&#x5B9A;&#xFF0C;&#x5B83;&#x4F1A;&#x7B80;&#x5355;&#x7684;&#x4E0E;package&#x7ED9;&#x51FA;&#x7684;package name&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x540D;&#x5B57;&#x901A;&#x5E38;&#x4E0D;&#x9002;&#x5408;&#x505A;&#x4E3A;Java&#x5305;&#x7684;&#x540D;&#x5B57;&#xFF08;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x901A;&#x5E38;&#x4E0D;&#x4EE5;&#x57DF;&#x540D;&#x5F00;&#x5934;&#xFF09;&#x3002;java_outer_classname&#x914D;&#x7F6E;&#x9879;&#x5B9A;&#x4E49;&#x4E86;&#x90A3;&#x4E9B;&#x5728;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x5305;&#x542B;&#x6240;&#x6709;&#x7C7B;&#x7684;&#x540D;&#x79F0;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;&#x5177;&#x4F53;&#x6307;&#x5B9A;java_outer_classname&#xFF0C;&#x5B83;&#x5C06;&#x4F1A;&#x8F6C;&#x6362;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x9A7C;&#x5CF0;&#x5F0F;&#x6765;&#x4EA7;&#x751F;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x201C;my_proto.proto&#x201D;&#x5C06;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x201C;MyProto&#x201D;&#x505A;&#x4E3A;outer class name(&#x7C7B;&#x7684;&#x6587;&#x4EF6;&#x540D;)&#x3002;</p>\n<p>&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x4F60;&#x7684;message&#x5B9A;&#x4E49;&#x3002;&#x4E00;&#x4E2A;message&#x53EA;&#x662F;&#x4E00;&#x7CFB;&#x5217;&#x5177;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x57DF;&#x7684;&#x96C6;&#x5408;&#x3002;&#x8BB8;&#x591A;&#x6807;&#x51C6;&#x7684;&#x7B80;&#x5355;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x505A;&#x4E3A;&#x53EF;&#x7528;&#x7684;&#x57DF;&#x7C7B;&#x578B;&#xFF0C;&#x5305;&#x62EC;bool, int32, float, double, &#x548C;string&#x3002;&#x4F60;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x5411;&#x4F60;&#x7684;message&#x4E2D;&#x6DFB;&#x52A0;&#x66F4;&#x591A;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x901A;&#x8FC7;&#x628A;&#x5176;&#x4ED6;&#x7684;message&#x7C7B;&#x578B;&#x5F53;&#x505A;&#x57DF;&#x7C7B;&#x578B;&#x4F7F;&#x7528;&#xFF0D;&#xFF0D;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;Person message&#x5305;&#x542B;PhoneNumber message&#xFF0C;&#x800C;AddressBook message&#x5305;&#x542B;Person message&#x3002;&#x4F60;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5185;&#x90E8;&#x5D4C;&#x5957;&#x5176;&#x5B83;message&#x7684;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;message&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;PhoneNumber&#x7C7B;&#x578B;&#x88AB;&#x5B9A;&#x4E49;&#x5728;Person&#x91CC;&#x9762;&#x3002;&#x4F60;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;enum&#x7C7B;&#x578B;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x4F60;&#x7684;&#x57DF;&#x62E5;&#x6709;&#x9884;&#x5B9A;&#x4E49;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x503C;&#xFF0D;&#xFF0D;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x5E0C;&#x671B;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;phone number&#x7684;&#x503C;&#x662F;MOBILE, HOME, &#x6216;&#x8005;WORK&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;</p>\n<p>&#x8FD9;&#x91CC;&#x5728;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x4E0A;&#x9762;&#x7684;&#x201C;=1&#x201D;&#xFF0C;&#x201C;=2&#x201D;&#x6807;&#x8BB0;&#xFF0C;&#x8FA8;&#x8BC6;&#x552F;&#x4E00;&#x7684;&#x201C;tag&#x201D;&#xFF0C;&#x8FD9;&#x4E9B;&#x201C;tag&#x201D;&#x662F;&#x57DF;&#x5728;&#x4E8C;&#x8FDB;&#x5236;&#x7F16;&#x7801;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x7684;&#x3002;Tag&#x7F16;&#x53F7;&#x4ECE;1&#x5230;15&#xFF0C;&#x9700;&#x8981;&#x6BD4;&#x66F4;&#x5927;&#x7684;&#x6570;&#x5B57;&#x5C11;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x51FA;&#x4E8E;&#x4F18;&#x5316;&#x8003;&#x8651;&#x4F60;&#x53EF;&#x4EE5;&#x51B3;&#x5B9A;&#x4F7F;&#x7528;&#x5E38;&#x7528;&#x7684;&#x6216;&#x8005;&#x91CD;&#x590D;&#x7684;&#x5143;&#x7D20;&#x3002;&#x800C;&#x4ECE;16&#x5230;&#x66F4;&#x9AD8;&#x7684;&#x7F16;&#x53F7;&#x7559;&#x7ED9;&#x4E0D;&#x5E38;&#x7528;&#x7684;&#x53EF;&#x9009;&#x5143;&#x7D20;&#x3002;&#x5728;&#x91CD;&#x590D;&#x57DF;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x7F16;&#x7801;tag number&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x4F7F;&#x7528;&#x91CD;&#x590D;&#x57DF;&#x5BF9;&#x4F18;&#x5316;&#x6765;&#x8BF4;&#x662F;&#x7279;&#x522B;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;</p>\n<p>&#x6BCF;&#x4E00;&#x4E2A;&#x57DF;&#x90FD;&#x5FC5;&#x987B;&#x88AB;&#x4E0B;&#x9762;&#x4E4B;&#x4E00;&#x7684;modifer&#x6CE8;&#x89E3;&#xFF1A;</p>\n<ul>\n<li>required&#xFF1A;&#x57DF;&#x7684;&#x503C;&#x5FC5;&#x987B;&#x88AB;&#x63D0;&#x4F9B;&#xFF0C;&#x5426;&#x5219;message&#x4F1A;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x201C;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;&#x201D;&#x3002;&#x8BD5;&#x56FE;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;message&#x5C06;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;RuntimeException&#x3002;&#x8F6C;&#x5316;&#x4E00;&#x4E2A;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;message&#x5C06;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;IOException&#x3002;&#x9664;&#x4E86;&#x8FD9;&#x4E9B;&#xFF0C;required&#x57DF;&#x7684;&#x884C;&#x4E3A;&#x548C;optional&#x57DF;&#x8868;&#x73B0;&#x76F8;&#x540C;&#x3002;</li>\n<li>optional&#xFF1A;&#x8BE5;&#x57DF;&#x53EF;&#x80FD;&#x88AB;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x672A;&#x88AB;&#x8BBE;&#x7F6E;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;optional&#x57DF;&#x672A;&#x88AB;&#x8BBE;&#x7F6E;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x503C;&#x5C06;&#x4F1A;&#x88AB;&#x4F7F;&#x7528;&#x3002;&#x5BF9;&#x4E8E;&#x7B80;&#x5355;&#x7C7B;&#x578B;&#x6765;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x5C31;&#x50CF;&#x6211;&#x4EEC;&#x5728;&#x4F8B;&#x5B50;&#x4E2D;&#x5BF9;phone number&#x7C7B;&#x578B;&#x6240;&#x505A;&#x7684;&#x90A3;&#x6837;&#x3002;&#x5426;&#x5219;&#xFF0C;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x7684;&#x503C;&#x5C06;&#x88AB;&#x4F7F;&#x7528;&#xFF1A;&#x6570;&#x503C;&#x7C7B;&#x578B;&#x662F;0&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x662F;&#x201D;&#x201D;&#xFF0C;&#x5E03;&#x5C14;&#x7C7B;&#x578B;&#x662F;false&#x3002;&#x5BF9;&#x4E8E;&#x5D4C;&#x5165;&#x5F0F;&#x7684;message&#x6765;&#x8BF4;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x603B;&#x662F;&#x8FD9;&#x4E2A;message&#x7684;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x57DF;&#x88AB;&#x8BBE;&#x7F6E;&#x8FC7;&#x7684;&#x201C;&#x9ED8;&#x8BA4;&#x5B9E;&#x4F8B;&#x201D;&#x6216;&#x201C;&#x539F;&#x578B;&#x201D;&#x3002;&#x8C03;&#x7528;&#x8BBF;&#x95EE;&#x5668;&#x53BB;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;optional&#x6216;&#x8005;required&#x57DF;&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x4E9B;&#x57DF;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x88AB;&#x5177;&#x4F53;&#x8BBE;&#x7F6E;&#xFF0C;&#x90A3;&#x4E48;&#x603B;&#x662F;&#x8FD4;&#x56DE;&#x57DF;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</li>\n<li>repeated&#xFF1A;&#x57DF;&#x5C06;&#x4F1A;&#x88AB;&#x91CD;&#x590D;&#x4EFB;&#x610F;&#x6B21;&#x6570;&#xFF08;&#x5305;&#x62EC;0&#x6B21;&#xFF09;&#x3002;&#x91CD;&#x590D;&#x7684;&#x503C;&#x7684;&#x987A;&#x5E8F;&#x5C06;&#x4F1A;&#x88AB;&#x4FDD;&#x5B58;&#x5728;protocol buffer&#x4E2D;&#x3002;&#x53EF;&#x4EE5;&#x628A;&#x91CD;&#x590D;&#x7684;&#x57DF;&#x60F3;&#x6210;&#x53D8;&#x957F;&#x7684;&#x6570;&#x7EC4;&#x3002; </li>\n</ul>\n</blockquote>\n<h3 id=\"&#x603B;&#x7ED3;\"><a href=\"#&#x603B;&#x7ED3;\" class=\"headerlink\" title=\"&#x603B;&#x7ED3;\"></a>&#x603B;&#x7ED3;</h3><p>&#x6700;&#x8FD1;&#x67E5;&#x770B;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;p2p&#x9879;&#x76EE;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x4E2D;&#x6307;&#x4EE4;&#x534F;&#x8BAE;&#x672C;&#x8EAB;&#x662F;&#x5DF2;&#x7ECF;&#x56FA;&#x5B9A;&#x597D;&#x7684;&#xFF0C;&#x5341;&#x5206;&#x9002;&#x5408;&#x4F7F;&#x7528;Protocol Buffer&#x4F5C;&#x4E3A;&#x534F;&#x8BAE;&#x547D;&#x4EE4;&#x4F20;&#x8F93;&#x3002;</p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cixq3mp950000ez0tzz1a60ri","tag_id":"cixq3mp9i0003ez0tbku8z86m","_id":"cixq3mp9v0007ez0tsf4qu8xx"},{"post_id":"cixq3mp9e0002ez0t3g0parex","tag_id":"cixq3mp9u0006ez0t5sa6dc4f","_id":"cixq3mp9v0009ez0tf6utbugt"},{"post_id":"cixq3mp9p0004ez0tylop7x2r","tag_id":"cixq3mp9v0008ez0tftr0t1ur","_id":"cixq3mp9w000bez0txc59vezw"},{"post_id":"cixq3mp9t0005ez0tn0ffjnld","tag_id":"cixq3mp9w000aez0tcdu710ay","_id":"cixq3mp9w000cez0tuv4khyeq"}],"Tag":[{"name":"分布式","_id":"cixq3mp9i0003ez0tbku8z86m"},{"name":"Net","_id":"cixq3mp9u0006ez0t5sa6dc4f"},{"name":"Java","_id":"cixq3mp9v0008ez0tftr0t1ur"},{"name":"Protocol Buffer","_id":"cixq3mp9w000aez0tcdu710ay"}]}}